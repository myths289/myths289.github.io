<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>React核心基础 | 蜗牛浪迹天涯</title><noscript>开启JavaScript才能访问本站哦~</noscript><link rel="icon" href="https://bu.dusays.com/2023/11/08/654af68b25bb8.jpg"><!-- index.css--><link rel="stylesheet" href="/css/index.css"><!-- inject head--><link rel="stylesheet" href="https://cdn3.codesign.qq.com/icons/7pOrz0WXB5ZWJPX/latest/iconfont.css"><link rel="stylesheet" href="/lib/snackbar.min.css"><!-- comment--><!-- pace 胶囊加载条(Capsule loading bar)--><script src="https://cdn.bootcdn.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!-- search--><script src="https://cdn.bootcdn.net/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script><!-- aplayer--><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css"><!-- swiper--><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/Swiper/9.2.4/swiper-bundle.min.css"><!-- echarts--><script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.2/echarts.min.js"></script><!-- 灰色纪念日(Gray Anniversary)--><!-- Open Graph--><meta name="description" content="# React React 简介React 简介 React 是什么呢？ 相信每个做开发的人对它都或多或少有一些印象； 这里我们来看一下官方对它的解释：用于构建用户界面的 JavaScript 库； 目前对于前端开发来说，几乎很少直接使用原生的 JavaScript 来开发应用程序，而"><!-- pwa--><script>(win => {
        win.saveToLocal = {
            set: function setWithExpiry(key, value, ttl) {
                if (ttl === 0)
                    return
                const now = new Date()
                const expiryDay = ttl * 86400000
                const item = {
                    value: value,
                    expiry: now.getTime() + expiryDay,
                }
                localStorage.setItem(key, JSON.stringify(item))
            },

            get: function getWithExpiry(key) {
                const itemStr = localStorage.getItem(key)

                if (!itemStr) {
                    return undefined
                }
                const item = JSON.parse(itemStr)
                const now = new Date()

                if (now.getTime() > item.expiry) {
                    localStorage.removeItem(key)
                    return undefined
                }
                return item.value
            }
        }

        const DarkModeStatus = localStorage.getItem('theme')
        if (DarkModeStatus !== null) {
            if (DarkModeStatus === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark')
            } else {
                document.documentElement.setAttribute('data-theme', 'light')
            }
        }

        const asideStatus = saveToLocal.get('aside-status')
        if (asideStatus !== undefined) {
            if (asideStatus === 'hide') {
                document.documentElement.classList.add('hide-aside')
            } else {
                document.documentElement.classList.remove('hide-aside')
            }
        }
    }
)(window)

console.log(
    "%c🔥 程序：Hexo | 主题：Hexo-Theme-Solitude | 作者：王卓Sco、亦封 | Github: https://github.com/DuoSco/Hexo-theme-solitude | 版本：v1.3.0 😄",
    "color: #fff; background: linear-gradient(-25deg, #a8edea, #fed6e3); padding: 8px 15px; border-radius: 8px; text-shadow: 2px 2px 4px white; color: black;"
);
</script><div><script src="/js/utils.js"></script><script src="/js/main.js"></script></div><!-- custom inject--><script>console.log("head")</script><!-- global head--><script>const GLOBAL_CONFIG = {
    root: '/',
    algolia: undefined,
    localsearch: {"preload":true,"path":"/search.xml"},
    runtime: '2024-01-01 00:00:00',
    lazyload: {
        enable: true,
        error: '/img/error_load.png'
    },
    hightlight: {
        enable: true,
        limit: 200,
        expand: false,
        copy: true,
    },
    lightbox: true,
    randomlinks: false,
    lang: {
        theme: {
            dark: '已切换至深色模式',
            light: '已切换至浅色模式',
        },
        copy: {
            success: '复制成功',
            error: '复制失败',
        },
        backtop: '返回顶部',
        time: {
            recent: '最近',
            yesterday: '昨天',
            berforeyesterday: '前天',
            daybefore: '天前',
            runtime: '天',
        },
        sayhello: {
            morning: `一日之计在于晨`,
            noon: `吃饱了才有力气干活`,
            afternoon: `集中精力，攻克难关`,
            night: `不要太劳累了，早睡更健康`,
            goodnight: `睡个好觉，保证精力充沛`,
        },
        search: {
            empty: '找不到你查询的内容：${query}',
            hit: '找到 ${hits} 条结果，用时 ${time} 毫秒',
            placeholder: '输入关键词快速查找',
        }
    },
    covercolor: {
        enable: true
    },
    comment: {
        enable: false,
        type: 'twikoo',
        commentBarrage: false,
        randomInfoStart: ["聪敏的","可爱的","美丽的"],
        randomInfoEnd: ["白菜","小可爱","小仙女"],
        twikoo: {
            url: '',
            accessToken: ''
        },
        waline: {
            url: '',
        }
    },
    rightside: {
        enable: false
    },
    ai:{
        enable: false,
        key: '',
        talk: '我是王卓Sco开发的摘要生成助理ScoGPT，ScoGPT在静态部署时进行摘要的撰写，并且在访客访问时通过ScoCorrection转译后的文本摘要实现工具。我在这里只负责已经生成的摘要显示，你无法与我直接沟通，但我可以回答一些预设的问题。',
        randomPost: false,
    },
    music:{
        enable: true,
    }
}</script><meta name="generator" content="Hexo 6.3.0"></head><body id="body"><!-- loading--><div id="loading-box" onclick="preloader.endLoading();" style="zoom:1"><div class="loading-bg"><img class="loading-img" src= "/img/loading.gif" data-lazy-src="https://bu.dusays.com/2023/11/08/654af68b25bb8.jpg" alt="loading image"></div></div><script>const preloader = {
    endLoading: () => {
        document.getElementById('loading-box').classList.add('loaded');
    },
    initLoading: () => {
        document.getElementById('loading-box').classList.remove('loaded');
    },
    removePaceDone: () => {
        document.getElementById('body').classList = 'pace-done';
    }
}
window.addEventListener('load', () => {
    preloader.endLoading();
});
window.addEventListener('pjax:send', () => {
    preloader.initLoading();
});
document.addEventListener('pjax:complete', () => {
    preloader.endLoading();
});</script><!-- console--><div id="console"><div class="close-btn" onclick="sco.hideConsole()"><i class="scoicon sco-close-fill"></i></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments" onclick="sco.hideConsole()"><div class="card-content"><div class="author-content-item-tips">互动</div><div class="author-content-item-title">最新评论</div></div><div class="aside-list"></div></div></div><div class="console-card-group-right"><div class="console-card tags" onclick="sco.hideConsole()"><div class="card-content"><div class="author-content-item-tips">标签</div><div class="author-content-item-title">寻找感兴趣的领域</div></div><div class="card-tag-cloud"></div></div><div class="console-card history" onclick="sco.hideConsole()"><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" onclick="pjax.loadUrl('/archives/2024/')" href="javascript:void(0);"><span class="card-archive-list-date">2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">61</span><span class="card-archive-list-count-unit">篇</span></div></a></li></ul></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="sco.switchDarkMode()" title="昼夜切换" href="javascript:void(0);"><i class="scoicon sco-moon-clear-fill"></i></a></div><div class="console-btn-item" id="consoleHideAside"><a class="asideSwitch" onclick="sco.switchHideAside()" title="边栏显示控制" href="javascript:void(0);"><i class="scoicon sco-side-bar-fill"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="sco.musicToggle()"><a class="music-switch" title="音乐开关" href="javascript:void(0);"><i class="scoicon sco-disc-fill"></i></a></div></div><div class="console-mask" onclick="sco.hideConsole()"></div></div><!-- sidebar--><div id="sidebar" style="zoom: 1;"><div id="menu-mask" style="display: none;"></div><div id="sidebar-menus"><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" onclick="sco.switchDarkMode()" href="javascript:void(0);"><i class="scoicon sco-moon-clear-fill"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/DuoSco/Hexo-Theme-solitude" title="Solitude"><img class="back-menu-item-icon" src="https://bu.dusays.com/2023/11/08/654af68b25bb8.jpg" alt="项目"><span class="back-menu-item-text">Solitude</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="scoicon sco-folder-fill"></i><span>文章列表</span></a></li><li><a class="site-page child" href="/categories/"><i class="scoicon sco-checkbox-multiple-blank-fill"></i><span>全部分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="scoicon sco-price-tag-fill"></i><span>全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/moments/"><i class="scoicon sco-wifi-fill"></i><span>鱼塘</span></a></li><li><a class="site-page child" href="/links/"><i class="scoicon sco-group-fill"></i><span>友情链接</span></a></li><li><a class="site-page child" href="javascript:travelling()"><i class="scoicon sco-gift-fill"></i><span>宝藏博主</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/equipment/"><i class="scoicon sco-laptop-line"></i><span>装备</span></a></li><li><a class="site-page child" href="/tlink/"><i class="scoicon sco-tools-fill"></i><span>工具箱</span></a></li><li><a class="site-page child" href="/music/"><i class="scoicon sco-laptop-line"></i><span>音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="scoicon sco-contacts-fill"></i><span>关于本站</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class="card-tag-cloud"></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav class="show" id="nav"><div id="nav-group"><div id="blog_name"><div class="back-home-button" tabindex="-1"><i class="back-home-button-icon scoicon sco-more-fill"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/DuoSco/Hexo-Theme-solitude" title="Solitude"><img class="back-menu-item-icon" src="https://bu.dusays.com/2023/11/08/654af68b25bb8.jpg" alt="项目"><span class="back-menu-item-text">Solitude</span></a></div></div></div></div><a id="site-name" href="/" title="返回博客主页" target="_self"><span class="scoicon">首页</span></a></div><div id="page-name-mask"><div id="page-name"><a id="page-name-text" onclick="sco.toTop()">React核心基础</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文库</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="scoicon sco-folder-fill"></i><span>文章列表</span></a></li><li><a class="site-page child" href="/categories/"><i class="scoicon sco-checkbox-multiple-blank-fill"></i><span>全部分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="scoicon sco-price-tag-fill"></i><span>全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/moments/"><i class="scoicon sco-wifi-fill"></i><span>鱼塘</span></a></li><li><a class="site-page child" href="/links/"><i class="scoicon sco-group-fill"></i><span>友情链接</span></a></li><li><a class="site-page child" href="javascript:travelling()"><i class="scoicon sco-gift-fill"></i><span>宝藏博主</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/equipment/"><i class="scoicon sco-laptop-line"></i><span>装备</span></a></li><li><a class="site-page child" href="/tlink/"><i class="scoicon sco-tools-fill"></i><span>工具箱</span></a></li><li><a class="site-page child" href="/music/"><i class="scoicon sco-laptop-line"></i><span>音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="scoicon sco-contacts-fill"></i><span>关于本站</span></a></li></ul></div></div></div><div id="nav-left"></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button"><a class="site-page" href="https://www.travellings.cn/go.html" title="开往-友链接力" target="_blank"><i class="scoicon sco-train-line"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机一篇文章" href="javascript:void(0);"><i class="scoicon sco-signal-tower-fill"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索"><i class="scoicon sco-search-line"></i></a></div><div class="nav-button" id="nav-console"><a class="console_switchbutton" onclick="sco.showConsole()" title="中控台" href="javascript:void(0);"><i class="scoicon sco-dashboard-fill"></i></a></div><div class="nav-button" id="nav-totop" onclick="sco.toTop()"><a class="totopbtn"><i class="scoicon sco-arrow-up-line"></i><span id="percent">0</span></a></div><div id="toggle-menu"><a class="site-page"><i class="scoicon sco-menu-line"></i></a></div></div></div></nav><div class="coverdiv" id="coverdiv"><img class="nolazyload" id="post-cover" src="https://img0.baidu.com/it/u=685784559,1532181365&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=1192&amp;h=500" alt="React核心基础"></div><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original" title="该文章为原创文章，注意版权协议">原创</a><span class="post-meta-categories"><a class="post-meta-categories" href="/categories/Web前端开发/">Web前端开发</a></span><div class="tag_share"><div class="post-meta__tag-list"></div></div></div></div><h1 class="post-title">React核心基础</h1><div id="post-meta"><div class="meta-secondline"><span class="post-meta-date" title="meta_posted 2024-01-23 11:00:00"><i class="post-meta-icon scoicon sco-calendar-todo-fill"></i><time datetime="2024-01-23T03:00:00.000Z">2024-01-23T03:00:00.000Z</time></span><span class="post-meta-date" title="meta_updated 2024-01-28 13:53:50"><i class="post-meta-icon scoicon sco-refresh-line"></i><time datetime="2024-01-28T05:53:50.959Z">2024-01-28T05:53:50.959Z</time></span><span class="post-meta-wordcount"><i class="post-meta-icon scoicon sco-word-fill" title="文章字数"></i><span class="word-count">30.4k</span><span class="post-meta-separator"></span><i class="post-meta-icon scoicon sco-clock-fill" title="阅读耗时"></i><span>133 min</span></span><span class="post-meta-position" title="作者IP归属地为衡阳"><i class="post-meta-icon scoicon sco-map-pin-fill"></i><span>衡阳</span></span><a class="post-meta-pv" href="/2024/01/23/Web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/303_React/30301_React%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80/" title="文章热度"><i class="post-meta-icon scoicon sco-fire-fill"></i><span id="busuanzi_value_page_pv"><i class="scoicon sco-loading-line"></i></span></a></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer" />
# React

<h2 id="React-简介"><a href="#React-简介" class="headerlink" title="React 简介"></a>React 简介</h2><h3 id="React-简介-1"><a href="#React-简介-1" class="headerlink" title="React 简介"></a>React 简介</h3><ul>
<li>React 是什么呢？<ul>
<li>相信每个做开发的人对它都或多或少有一些印象；</li>
<li>这里我们来看一下官方对它的解释：<strong>用于构建用户界面的 JavaScript 库</strong>；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/982d67a0ec6b4978b007041581fccc3c" alt="1663993425782"></p>
<ul>
<li>目前对于前端开发来说，几乎很少直接使用原生的 JavaScript 来开发应用程序，而是选择一个 JavaScript 库（框架）。<ul>
<li>在过去的很长时间内，jQuery 是被使用最多的 JavaScript 库；</li>
<li>在过去的一份调查中显示，全球前 10,000 个访问最高的网站中，有 65% 使用了 jQuery，是当时最受欢迎的 JavaScript 库；</li>
<li>但是，目前甚至已经处于淘汰的边缘了；</li>
</ul>
</li>
<li>而无论是国内外，最流行的其实是三大框架：<strong>Vue、React、Angular</strong>。</li>
</ul>
<h3 id="React-在前端的地位"><a href="#React-在前端的地位" class="headerlink" title="React 在前端的地位"></a>React 在前端的地位</h3><ul>
<li>目前前端最流行的是三大框架：<strong>Vue、React、Angular</strong>。</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/27cc75625c914f5a82ed21aff8e7d02f" alt="1663993643418"></p>
<h3 id="React-的技术特点"><a href="#React-的技术特点" class="headerlink" title="React 的技术特点"></a>React 的技术特点</h3><ul>
<li><p>React 由 Facebook 来更新和维护，它是大量优秀程序员的思想结晶：</p>
<ul>
<li>React 的流行不仅仅局限于普通开发工程师对它的认可；</li>
<li><strong>大量流行的其他框架借鉴 React 的思想</strong>；</li>
</ul>
</li>
<li><p>Vue.js 框架设计之初，有很多的灵感来自 Angular 和 React。</p>
<ul>
<li>包括 Vue3 很多新的特性，也是借鉴和学习了 React；</li>
<li>比如 React Hooks 是开创性的新功能（也是我们课程的重点）；</li>
<li><strong>Vue Composition API 学习了 React Hooks 的思想</strong>；</li>
</ul>
</li>
<li><p>Flutter 的很多灵感都来自 React，来自官网的一段话：（SwiftUI 呢）</p>
<ul>
<li>事实上 Flutter 中的 Widget – Element – RenderObject；</li>
<li>对应 React 的就是 JSX – 虚拟 DOM – 真实 DOM；</li>
</ul>
</li>
<li><p>所以 <strong>React 可以说是前端的先驱者，它总是会引领整个前端的潮流</strong>。</p>
</li>
</ul>
<h3 id="Vue和React的选择"><a href="#Vue和React的选择" class="headerlink" title="Vue和React的选择"></a>Vue和React的选择</h3><ul>
<li>首先，React 和 Vue 是前端开发人员必须掌握的两个框架。</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/ea18d1a1adcb40deaf07b6fd95ad157a" alt="1663993978733"></p>
<ul>
<li>下面的观点是一个目前比较普遍的共识，没有贬低任何框架的意思。<ul>
<li><p>大中型公司选择 React 会较多，灵活和稳定；</p>
</li>
<li><p>中小型公司选择 Vue 会较多，易上手和代码统一；</p>
</li>
<li><p>难度：React 难度大于 Vue</p>
</li>
<li><p>工资：React 工资大于 Vue</p>
</li>
</ul>
</li>
</ul>
<h3 id="React-课堂体系"><a href="#React-课堂体系" class="headerlink" title="React 课堂体系"></a>React 课堂体系</h3><p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/b4fbeebe94ac43b8a21616984ae6f700" alt="1663994136592"></p>
<ul>
<li>React 和 Vue 都是前端工程师必须掌握的两个框架：<ul>
<li>大多数同学都是学习了 Vue，并且刚开始工作都是使用的 Vue，所以通常对 Vue 是有深入的感情的（某些同学可能是小程序）；</li>
<li>但是在前端整个职业发展的过程中，不能仅仅将自己局限在某一个框架或者技术中；</li>
<li>并且 React 是作为前端进阶来说自己必须要掌握的一个框架；</li>
</ul>
</li>
<li>本次课程要求：<ul>
<li><strong>本课程要求掌握前端的核心开发语言：HTML、CSS、JavaScript</strong></li>
<li><strong>React 本身是 JavaScript 的要求相对会更高一些</strong>，所以也需要掌握一些<strong>高级的 JavaScript 语法</strong>，比如 ES6 以上的语法、this 绑定规则等等；</li>
<li>整个课程从零讲解 React，所以并不要求之前学习过 React 相关的知识。</li>
<li>如果你之前已经掌握了一些 React，也可以从课程中学习到非常多其他的核心知识和实战细节，也包括原理、源码、架构等知识内容。</li>
</ul>
</li>
<li>所以无论你目前处于前端哪一个阶段，都可以在这个过程中有很多的收获。</li>
</ul>
<h2 id="邂逅React开发"><a href="#邂逅React开发" class="headerlink" title="邂逅React开发"></a>邂逅React开发</h2><h3 id="React-的介绍"><a href="#React-的介绍" class="headerlink" title="React 的介绍"></a>React 的介绍</h3><ul>
<li>React 是什么<ul>
<li><strong>React：用于构建用户界面的 JavaScript 库；</strong></li>
<li>React 的官网文档：<a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/">https://zh-hans.reactjs.org/</a></li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/08de81fe54cb40fcbba1609f4652a311" alt="1663998324637"></p>
<p><img src= "/img/loading.gif" data-lazy-src="/images/1663998337353.png" alt="1663998337353"></p>
<h3 id="React-的特点"><a href="#React-的特点" class="headerlink" title="React 的特点"></a>React 的特点</h3><h4 id="声明式编程"><a href="#声明式编程" class="headerlink" title="声明式编程"></a>声明式编程</h4><ul>
<li>声明式编程：<ul>
<li>声明式编程是目前整个大前端开发的模式：Vue、React、Flutter、SwiftUI；</li>
<li>它允许我们<strong>只需要维护自己的状态，当状态改变时，React 可以根据最新的状态去渲染我们的 UI 界面</strong>；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/42d9ed68cce74c2a9550c9510b2a75c0" alt="1663998444461"></p>
<h4 id="组件化开发"><a href="#组件化开发" class="headerlink" title="组件化开发"></a>组件化开发</h4><ul>
<li>组件化开发：<ul>
<li>组件化开发页面目前前端的流行趋势，我们会将复杂的界面拆分成一个个小的组件；</li>
<li>如何合理的进行组件的划分和设计也是后面我会讲到的一个重点；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/5375680cc30448d79bb6a156675c5487" alt="1663998520366"></p>
<h4 id="多平台适配"><a href="#多平台适配" class="headerlink" title="多平台适配"></a>多平台适配</h4><ul>
<li>多平台适配：<ul>
<li>2013 年，React 发布之初主要是开发 Web 页面；</li>
<li>2015 年，Facebook 推出了 ReactNative，用于开发移动端跨平台；（虽然目前 Flutter 非常火爆，但是还是有很多公司在使用 ReactNative）；</li>
<li>2017 年，Facebook 推出 ReactVR，用于开发虚拟现实 Web 应用程序；（ VR 也会是一个火爆的应用场景）；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/1e87a64998294517853901fcd8e4262d" alt="1663998570934"></p>
<h3 id="React-开发依赖"><a href="#React-开发依赖" class="headerlink" title="React 开发依赖"></a>React 开发依赖</h3><h4 id="React-开发依赖-1"><a href="#React-开发依赖-1" class="headerlink" title="React 开发依赖"></a>React 开发依赖</h4><ul>
<li>开发 React 必须依赖三个库：<ul>
<li><strong>react：包含 react 所必须的核心代码</strong></li>
<li><strong>react-dom：react 渲染在不同平台所需要的核心代码</strong></li>
<li><strong>babel：将 jsx 转换成 React 代码的工具</strong></li>
</ul>
</li>
<li>第一次接触 React 会被它繁琐的依赖搞蒙，居然依赖这么多东西：<ul>
<li>对于 Vue 来说，我们只是依赖一个 vue.js 文件即可，但是 react 居然要依赖三个包。</li>
<li>其实呢，这三个库是各司其职的，目的就是让每一个库只单纯做自己的事情;</li>
<li>在 React 的 0.14 版本之前是没有 react-dom 这个概念的，所有功能都包含在 react 里；</li>
</ul>
</li>
<li>为什么要进行拆分呢？原因就是 react-native。<ul>
<li>react 包中包含了 react web 和 react-native 所共同拥有的核心代码。</li>
<li>react-dom 针对 web 和 native 所完成的事情不同：<ul>
<li>web 端：react-dom 会将 jsx 最终渲染成真实的 DOM，显示在浏览器中</li>
<li>native 端：react-dom 会将 jsx 最终渲染成原生的控件（比如 Android 中的 Button，iOS 中的 UIButton）。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="Babel与React的关系"><a href="#Babel与React的关系" class="headerlink" title="Babel与React的关系"></a>Babel与React的关系</h4><ul>
<li>babel 是什么呢？<ul>
<li>Babel ，又名 Babel.js。</li>
<li><strong>Babel  是目前前端使用非常广泛的编译器、转移器</strong></li>
<li>比如当下很多浏览器并不支持 ES6 语法,TS, JSX 等语法，但是这些语法确实非常的简洁和方便，我们开发时希望使用它。</li>
<li>那么编写源码时我们就<strong>可以使用 ES6 等这些高级语法来编写，之后通过 Babel 工具，将 ES6 等这么高级语法转成大多数浏览器都支持的 ES5 的语法。</strong></li>
</ul>
</li>
<li>React 和 Babel 的关系：<ul>
<li>默认情况下开发 React 其实可以不使用 babel。</li>
<li>但是前提是我们自己使用 React.createElement 来编写源代码，它编写的代码非常的繁琐和可读性差。</li>
<li>那么我们就<strong>可以直接编写 jsx（JavaScript XML）的语法，并且让 babel 帮助我们转换成 React.createElement</strong></li>
<li>后续还会详细讲到；</li>
</ul>
</li>
</ul>
<h4 id="React-的依赖引入"><a href="#React-的依赖引入" class="headerlink" title="React 的依赖引入"></a>React 的依赖引入</h4><ul>
<li>所以，我们在编写 React 代码时，这三个依赖都是必不可少的,并且<strong>引入顺序也分先后顺序</strong>。</li>
<li>那么，如何添加这三个依赖：<ul>
<li><strong>方式一：直接 CDN 引入</strong></li>
<li><strong>方式二：下载后，添加本地依赖</strong></li>
<li><strong>方式三：通过 npm 管理（后续脚手架再使用）</strong></li>
</ul>
</li>
<li>暂时我们直接通过 CDN 引入，来演练下面的示例程序：<ul>
<li>这里有一个 crossorigin 的属性，这个属性的目的是为了拿到跨域脚本的错误信息</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@18/umd/react.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@18/umd/react-dom.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="React-小案例"><a href="#React-小案例" class="headerlink" title="React 小案例"></a>React 小案例</h3><h4 id="案例需求分析"><a href="#案例需求分析" class="headerlink" title="案例需求分析"></a>案例需求分析</h4><ul>
<li>为了演练 React，我们可以提出一个小的需求：<ul>
<li>在界面显示一个文本：Hello World</li>
<li>点击下方的一个按钮，点击后文本改变为 Hello React</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/58910b8bd2e54baa909fc764fa73e691" alt="1663998673323"></p>
<ul>
<li><strong>该案例的代码会在后面展示</strong></li>
<li>当然，你也可以使用 jQuery 和 Vue 来实现，甚至是原生方式来实现，对它们分别进行对比学习</li>
</ul>
<h4 id="Hello-World-案例"><a href="#Hello-World-案例" class="headerlink" title="Hello World 案例"></a>Hello World 案例</h4><ul>
<li>第一步：在界面上通过 React 显示一个 Hello World<ul>
<li>注意：这里我们编写 React 的 script 代码中，必须添加 <strong>type&#x3D;”text&#x2F;babel”<strong>，</strong>作用是可以让 babel 解析 jsx 的语法</strong></li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@18/umd/react.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@18/umd/react-dom.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/babel&quot;</span>&gt;</span><span class="language-javascript"> <span class="comment">// script 标签的类型必须是 type=&quot;text/babel&quot;</span></span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// ... </span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React 18 之前的写法: </span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//========================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// React 18 之后的写法:</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>ReactDOM.createRoot 函数：用于创建一个 React 根，之后渲染的内容会包含在这个根中<ul>
<li>参数：将渲染的内容，挂载到哪一个 HTML 元素上<ul>
<li>这里我们已经提定义一个 id 为 app 的 div</li>
</ul>
</li>
</ul>
</li>
<li>root.render 函数:<ul>
<li>参数：要渲染的根组件</li>
</ul>
</li>
<li>我们可以通过 <code>&#123; &#125; </code>语法来引入外部的变量或者表达式</li>
</ul>
<h4 id="Hello-React-案例"><a href="#Hello-React-案例" class="headerlink" title="Hello React 案例"></a>Hello React 案例</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// React 18 之后的写法:</span></span><br><span class="line"><span class="comment">// 创建 root 实例对象</span></span><br><span class="line">  <span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 01 定义变量</span></span><br><span class="line">  <span class="keyword">let</span> message = <span class="string">&quot;hello World&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 02 定义按钮的点击事件回调</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">btnClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 05 修改数据</span></span><br><span class="line">    message = <span class="string">&quot;hello React&quot;</span></span><br><span class="line">    <span class="comment">// 06 重新渲染页面</span></span><br><span class="line">    <span class="title function_">rootRender</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 03 封装一个渲染函数</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">rootRender</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 渲染页面</span></span><br><span class="line">    root.<span class="title function_">render</span>((</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;btnClick&#125;</span>&gt;</span>修改文本<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    ))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 04 初次渲染页面</span></span><br><span class="line">  <span class="title function_">rootRender</span>()</span><br></pre></td></tr></table></figure>

<h3 id="VScode代码片段"><a href="#VScode代码片段" class="headerlink" title="VScode代码片段"></a>VScode代码片段</h3><ul>
<li>我们在前面练习 React 的过程中，有些代码片段是需要经常写的，我们在 VSCode 中我们可以生成一个代码片段，方便我们快速生成。</li>
<li>VSCode 中的代码片段有固定的格式，所以我们一般会借助于一个在线工具来完成。</li>
<li>具体的步骤如下：<ul>
<li>第一步，复制自己需要生成代码片段的代码；</li>
<li>第二步，<a target="_blank" rel="noopener" href="https://snippet-generator.app/">https://snippet-generator.app/</a> , 在该网站中生成代码片段；</li>
<li>第三步，在 VSCode 中配置代码片段；</li>
</ul>
</li>
</ul>
<h2 id="组件化开发-1"><a href="#组件化开发-1" class="headerlink" title="组件化开发"></a>组件化开发</h2><h3 id="Hello-案例组件化"><a href="#Hello-案例组件化" class="headerlink" title="Hello 案例组件化"></a>Hello 案例组件化</h3><ul>
<li>整个逻辑其实可以看做一个整体，那么我们就可以将其封装成一个组件：<ul>
<li>我们说过 <strong>root.render 参数是一个 HTML 元素或者一个组件</strong>；</li>
<li>所以我们可以先将之前的业务逻辑封装到一个组件中，然后传入到 ReactDOM.render 函数中的第一个参数；</li>
</ul>
</li>
<li>在React中，如何封装一个组件呢？这里我们暂时使用类的方式封装组件：<ul>
<li><strong>定义一个类（类名大写，组件的名称是必须首字母大写，小写会被认为是 HTML 元素），并且继承自 React.Component</strong></li>
<li>实现当前组件的 render 函数<ul>
<li>render 当中返回的 jsx 内容，就是之后 React 会帮助我们渲染的内容</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义一个类组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 1.1 组件数据</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Hello World&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.2 组件方法 , setState 方法: 内部会进行数据的修改,并会重新执行 render 函数,重新渲染页面</span></span><br><span class="line">  <span class="title function_">btnClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 使用 ES6 的函数语法定义的事件回调,如果在绑定事件时,没有通过 bind 修改 this 的指向,则 this 为 undefined</span></span><br><span class="line">    <span class="comment">// 		因为类中的方法,默认开启局部严格模式,这是类的特性,和 react 没有关系,经过 babel 编译后的代码也会开启严格模式</span></span><br><span class="line">    <span class="comment">// 		setState 方法是从父类 Component 继承来的,并不是当前组件实例对象所有</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Hello React&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.3 渲染内容 , render 函数中的 this 指向当前组件实例对象</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;this.state.message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.btnClick.bind(this)&#125;</span>&gt;</span>修改文本<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 将组件渲染到页面中</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure>

<h3 id="数据依赖"><a href="#数据依赖" class="headerlink" title="数据依赖"></a>数据依赖</h3><ul>
<li>组件化问题一：数据在哪里定义？</li>
<li>在组件中的数据，我们可以分成两类：<ul>
<li><strong>参与界面更新的数据</strong>：当数据变量时，需要更新组件渲染的内容；</li>
<li><strong>不参与界面更新的数据</strong>：当数据变量时，不需要更新将组建渲染的内容；</li>
</ul>
</li>
<li>参与界面更新的数据我们也可以称之为是<strong>参与数据流，这个数据是定义在当前对象的 state 中</strong><ul>
<li>我们可以通过在构造函数中 this.state &#x3D; { 定义的数据 }</li>
<li>当我们的数据发生变化时，我们可以调用 this.setState 来更新数据，并且通知 React 进行 update 操作；<ul>
<li>在进行 update 操作时，就会重新调用 render 函数，并且使用最新的数据，来渲染界面</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="方法的-this-指向问题"><a href="#方法的-this-指向问题" class="headerlink" title="方法的 this 指向问题"></a>方法的 this 指向问题</h3><ul>
<li>组件化问题二：事件绑定中的 this<ul>
<li>在类中直接定义一个函数，并且将这个函数绑定到元素的 onClick 事件上，当前这个函数的this指向的是谁呢？</li>
</ul>
</li>
<li>默认情况下是 undefined<ul>
<li>很奇怪，居然是 undefined；</li>
<li>因为在正常的 DOM 操作中，监听点击，监听函数中的 this 其实是节点对象（比如说是 button 对象）；</li>
<li>这次因为 React 并不是直接渲染成真实的 DOM，我们所编写的 button 只是一个语法糖，它的本质是 React 的 Element 对象；</li>
<li>那么在这里发生监听的时候，react 在执行函数时并没有绑定 this，默认情况下就是一个 undefined；</li>
<li><strong>类组件中的方法,默认会开启局部严格模式,类中的方法中的 this 就是 undefined , 这是类的特性,和 react 没有关系</strong></li>
<li><strong>经过 babel 编译后的代码,也会开启严格模式</strong></li>
</ul>
</li>
<li>我们在绑定的函数中，可能想要使用当前对象，比如执行 this.setState 函数，就必须拿到当前对象的 this<ul>
<li>我们就需要在传入函数时，给这个函数直接绑定 this</li>
<li>类似于下面的写法：</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeText.bind(this)&#125;</span>&gt;</span>改变文本<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>后面事件绑定的章节中会详细解析解决 this 的指向问题的多种方法</li>
</ul>
<h3 id="组件化开发案例"><a href="#组件化开发案例" class="headerlink" title="组件化开发案例"></a>组件化开发案例</h3><h4 id="电影列表展示"><a href="#电影列表展示" class="headerlink" title="电影列表展示"></a>电影列表展示</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义一个类组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 1.1 组件数据</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">movies</span>: [<span class="string">&quot;星际穿越&quot;</span>, <span class="string">&quot;流浪地球&quot;</span>, <span class="string">&quot;独行月球&quot;</span>, <span class="string">&quot;大话西游&quot;</span>, <span class="string">&quot;火星救援&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.2 渲染内容</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>电影列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            this.state.movies.map((item,index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 将组件渲染到页面中</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure>

<h4 id="计数器案例"><a href="#计数器案例" class="headerlink" title="计数器案例"></a>计数器案例</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 App 根组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 1.1 组件数据</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;当前计数:&quot;</span>,</span><br><span class="line">      <span class="attr">counter</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.2 组件方法</span></span><br><span class="line">  increment = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">counter</span> + <span class="number">1</span> <span class="comment">// 不能使用自增 ++</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  decrement = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">counter</span> - <span class="number">1</span> <span class="comment">// 不能使用自减 --</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.3 渲染内容</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; message, counter &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;counter&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.increment&#125;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.decrement&#125;</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将组件渲染到页面中</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure>

<h2 id="React-JSX语法"><a href="#React-JSX语法" class="headerlink" title="React JSX语法"></a>React JSX语法</h2><h3 id="认识-JSX"><a href="#认识-JSX" class="headerlink" title="认识 JSX"></a>认识 JSX</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 创建虚拟 DOM</span></span><br><span class="line"><span class="keyword">const</span> element = <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span> <span class="comment">// JSX</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 将虚拟 DOM渲染到页面中</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(element)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>这段 element 变量的声明右侧赋值的标签语法是什么呢？<ul>
<li>它不是一段字符串（因为没有使用引号包裹）；</li>
<li>它看起来是一段 HTML 元素，但是我们能在 js 中直接给一个变量赋值 html 吗？<ul>
<li>其实是不可以的，如果我们将 <code>type=&quot;text/babel&quot;</code> 去除掉，那么就会出现语法错误；</li>
<li>它到底是什么呢？其实它是一段 <strong>JSX 的语法</strong>；</li>
</ul>
</li>
</ul>
</li>
<li>JSX 是什么？<ul>
<li><strong>JSX 是一种 JavaScript 的语法扩展</strong>（extension），也在很多地方称之为 JavaScript XML，因为看起就是一段 XML 语法；</li>
<li>它<strong>用于描述我们的 UI 界面</strong>，并且可以和 JavaScript 融合在一起使用；</li>
<li>它不同于 Vue 中的模块语法，你不需要专门学习模块语法中的一些指令（比如 v-for、v-if、v-else、v-bind）；</li>
</ul>
</li>
</ul>
<h3 id="为什么选择-JSX"><a href="#为什么选择-JSX" class="headerlink" title="为什么选择 JSX"></a>为什么选择 JSX</h3><ul>
<li><strong>React 认为渲染逻辑本质上与其他 UI 逻辑存在内在耦合</strong><ul>
<li><strong>比如 UI 需要绑定事件（button、a 原生等等）；</strong></li>
<li><strong>比如 UI 中需要展示数据状态；</strong></li>
<li><strong>比如在某些状态发生改变时，又需要改变 UI；</strong></li>
</ul>
</li>
<li><strong>他们之间是密不可分，所以 React 没有将标记分离到不同的文件中，而是将它们组合到了一起，这个地方就是组件（Component）</strong>；<ul>
<li>当然，后面我们还是会继续学习更多组件相关的东西；</li>
</ul>
</li>
<li>在这里，我们只需要知道，<strong>JSX 其实是嵌入到 JavaScript 中的一种结构语法</strong>；</li>
</ul>
<h3 id="JSX-的书写规范"><a href="#JSX-的书写规范" class="headerlink" title="JSX 的书写规范"></a>JSX 的书写规范</h3><ul>
<li><strong>JSX 的顶层只能有一个根元素</strong>，所以我们很多时候会在外层包裹一个 div 元素（或者使用后面我们学习的 Fragment ）；</li>
<li>为了方便阅读，我们<strong>通常在 jsx 的外层包裹一个小括号<code> ()</code>，这样可以方便阅读，并且 jsx 可以进行换行书写</strong>；</li>
<li>JSX 中的标签可以是单标签，也可以是双标签；<ul>
<li>注意：<strong>如果是单标签，也必须结束</strong>；<ul>
<li>比如 img , input 等标签,可以加<code>/</code>闭合,也可以写结束标签</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="JSX的使用"><a href="#JSX的使用" class="headerlink" title="JSX的使用"></a>JSX的使用</h3><h4 id="JSX-中的注释"><a href="#JSX-中的注释" class="headerlink" title="JSX 中的注释"></a>JSX 中的注释</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.3 渲染内容</span></span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; message &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* 我是 jsx 的一个注释 */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="JSX-嵌入变量"><a href="#JSX-嵌入变量" class="headerlink" title="JSX 嵌入变量"></a>JSX 嵌入变量</h4><ul>
<li>情况一：<strong>当变量是 Number、String、Array 类型时，可以直接显示</strong></li>
<li>情况二：<strong>当变量是 null、undefined、Boolean 类型时，内容为空</strong><ul>
<li>如果希望可以显示 null、undefined、Boolean，那么需要转成字符串；</li>
<li>转换的方式有很多，比如 toString 方法、和空字符串拼接，String (变量)等方式；</li>
</ul>
</li>
<li>情况三：<strong>不能直接将 Object 对象类型作为子元素（not valid as a React child）,否则会报错,但是可以读取对象中的属性</strong></li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 App 根组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 组件数据</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Hello World&quot;</span>,</span><br><span class="line">      <span class="attr">names</span>: [<span class="string">&quot;acb&quot;</span>, <span class="string">&quot;cba&quot;</span>, <span class="string">&quot;nba&quot;</span>],</span><br><span class="line"></span><br><span class="line">      <span class="attr">aaa</span>: <span class="literal">undefined</span>,</span><br><span class="line">      <span class="attr">bbb</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">ccc</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">      <span class="attr">friend</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 渲染内容</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; counter, message, names, friend &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">const</span> &#123; aaa, bbb, ccc &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 1. 当变量是 Number、String、Array 类型时，可以直接显示*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;counter&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;names&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        &#123;/* 2. 当变量的值是 null、undefined、Boolean 类型时，页面内容为空；可以通过转为字符串类型显示*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;aaa&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;bbb&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;ccc&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        &#123;/* 3. 直接放一个对象会报错 , 对象类型不能作为子元素进行显示,但是可以读取对象中的属性 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;friend.name&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将组件渲染到页面中</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="JSX-嵌入表达式"><a href="#JSX-嵌入表达式" class="headerlink" title="JSX 嵌入表达式"></a>JSX 嵌入表达式</h4><ul>
<li>运算表达式</li>
<li>三元运算符</li>
<li>执行一个函数</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 App 根组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 1.1 组件数据</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">firstName</span>: <span class="string">&quot;jack&quot;</span>,</span><br><span class="line">      <span class="attr">lastName</span>: <span class="string">&quot;jobe&quot;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">      <span class="attr">movies</span>: [<span class="string">&quot;星际穿越&quot;</span>, <span class="string">&quot;流浪地球&quot;</span>, <span class="string">&quot;独行月球&quot;</span>, <span class="string">&quot;大话西游&quot;</span>, <span class="string">&quot;火星救援&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.2 组件方法</span></span><br><span class="line">  getMovieEls = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> liEls = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">movies</span>.<span class="title function_">map</span>(<span class="function"><span class="params">movie</span> =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;movie&#125;</span>&gt;</span>&#123;movie&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>)</span><br><span class="line">    <span class="keyword">return</span> liEls</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.3 渲染内容</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; firstName, lastName, age, movies &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">const</span> fullName = firstName + lastName</span><br><span class="line">    <span class="keyword">const</span> ageText = age &gt;= <span class="number">18</span> ? <span class="string">&quot;成年人&quot;</span> : <span class="string">&quot;未成年人&quot;</span></span><br><span class="line">    <span class="keyword">const</span> liEls = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">movies</span>.<span class="title function_">map</span>(<span class="function"><span class="params">movie</span> =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;movie&#125;</span>&gt;</span>&#123;movie&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 4.可以插入对应的表达式*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;10 + 20&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;firstName + &quot; &quot; + lastName&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;fullName&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        &#123;/* 5.可以插入三元运算符*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;ageText&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;age &gt;= 18 ? &quot;成年人&quot; : &quot;未成年人&quot;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        &#123;/* 6.可以调用方法获取结果*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;liEls&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;this.state.movies.map(movie =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;movie&#125;</span>&gt;</span>&#123;movie&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;this.getMovieEls()&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将组件渲染到页面中</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="JSX-绑定属性"><a href="#JSX-绑定属性" class="headerlink" title="JSX 绑定属性"></a>JSX 绑定属性</h4><ul>
<li>比如元素都会有 title 属性</li>
<li>比如 img 元素会有 src 属性</li>
<li>比如 a 元素会有 href 属性</li>
<li>比如元素可能需要绑定 class</li>
<li>比如原生使用内联样式 style</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 App 根组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 1.1 组件数据</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;我是标题&quot;</span>,</span><br><span class="line">      <span class="attr">imgURL</span>: <span class="string">&quot;https://img1.baidu.com/it/u=133990705,310893509&amp;fm=253&amp;app=120&amp;size=w931&amp;n=0&amp;f=JPEG&amp;fmt=auto?sec=1667667600&amp;t=a29e7543c3f08fa9b38d6931b7529f95&quot;</span>,</span><br><span class="line">      <span class="attr">href</span>: <span class="string">&quot;http://www.baidu.com&quot;</span>,</span><br><span class="line">      <span class="attr">isActive</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">objStyle</span>: &#123; <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>, <span class="attr">fontSize</span>: <span class="string">&quot;50px&quot;</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.2 组件方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.3 渲染内容</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; title, imgURL, href, isActive, objStyle &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">const</span> className = <span class="string">`abc cba <span class="subst">$&#123;isActive ? <span class="string">&quot;active&quot;</span> : <span class="string">&quot;&quot;</span>&#125;</span>`</span></span><br><span class="line">    <span class="keyword">const</span> classList = [<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;edf&quot;</span>, <span class="string">&quot;ghi&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isActive) &#123;</span><br><span class="line">      classList.<span class="title function_">push</span>(<span class="string">&quot;active&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; /* 1.基本属性绑定 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">title</span>=<span class="string">&#123;title&#125;</span>&gt;</span>我是h2元素<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;imgURL&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#123;href&#125;</span>&gt;</span>百度一下<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        &#123; /* 2.绑定class属性: 需要使用 className */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span>&gt;</span>哈哈哈哈<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&#123;classList.join(</span>&quot; &quot;)&#125;&gt;</span>哈哈哈哈<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        &#123; /* 3.绑定style属性: 绑定对象类型 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> &quot;<span class="attr">red</span>&quot;, <span class="attr">fontSize:</span> &quot;<span class="attr">50px</span>&quot; &#125;&#125;&gt;</span>呵呵呵呵<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">style</span>=<span class="string">&#123;objStyle&#125;</span>&gt;</span>呵呵呵呵<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将组件渲染到页面中</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#root&quot;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="React-事件绑定"><a href="#React-事件绑定" class="headerlink" title="React 事件绑定"></a>React 事件绑定</h2><h3 id="React-事件绑定-1"><a href="#React-事件绑定-1" class="headerlink" title="React 事件绑定"></a>React 事件绑定</h3><ul>
<li>如果原生 DOM 原生有一个监听事件，我们可以如何操作呢？<ul>
<li>方式一：<strong>获取 DOM 原生，添加监听事件</strong>；</li>
<li>方式二：<strong>在 HTML 原生中，直接绑定 onclick</strong>；</li>
</ul>
</li>
<li>在 React 中是如何操作呢？我们来实现一下 React 中的事件监听，这里主要有两点不同<ul>
<li>React 事件的<strong>命名采用小驼峰式（camelCase），而不是纯小写</strong>；</li>
<li>我们需要<strong>通过<code>&#123;&#125;</code>传入一个事件处理函数</strong>，这个函数会在事件发生时被执行；</li>
</ul>
</li>
</ul>
<h3 id="this-绑定"><a href="#this-绑定" class="headerlink" title="this 绑定"></a>this 绑定</h3><ul>
<li>在事件执行后，我们可能需要获取当前类的对象中相关的属性，这个时候需要用到 this<ul>
<li>如果我们这里直接打印 this，也会发现它是一个 undefined</li>
</ul>
</li>
<li>为什么是 undefined 呢<ul>
<li>原因是 btnClick 函数并不是我们主动调用的，而且当 button 发生改变时，React 内部调用了 btnClick 函数；</li>
<li>而它内部调用时，并不知道要如何绑定正确的 this；</li>
</ul>
</li>
<li>如何解决 this 的问题呢？<ul>
<li>方案一：bind 给 btnClick 显示绑定 this</li>
<li>方案二：使用 ES6 class fields 语法</li>
<li>方案三：事件监听时传入箭头函数（个人推荐）</li>
</ul>
</li>
</ul>
<h3 id="解决-this-指向问题"><a href="#解决-this-指向问题" class="headerlink" title="解决 this 指向问题"></a>解决 this 指向问题</h3><ul>
<li><strong>类中的方法,默认开启局部严格模式 , this 是 undefined , 这是类的特性,和 react 没有关系</strong></li>
</ul>
<h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><ul>
<li>使用 ES6 的函数增强语法定义的事件回调, <strong>可以在构造器中,通过 bind 方法修改方法的 this 指向</strong>,绑定事件时无需再修改 this 指向</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 01 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;hello world&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    // 使用 ES6 的函数语法定义的事件回调,可以在构造器中修改 this 的指向,绑定事件时无需再修改 this 指向</span><br><span class="line">    this.btnClick = this.btnClick.bind(this)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 02 组件方法 , setState 方法: 内部会进行数据的修改,并会重新执行 render 函数,重新渲染页面</span><br><span class="line">  btnClick() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      message: &quot;Hello React&quot;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 03 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;this.state.message&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;this.btnClick&#125;&gt;修改文本&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><ul>
<li>使用 ES6 的函数增强语法定义的事件回调, **可以在绑定事件时,通过 bind 修改 this 指向,**无需再在构造器中多写一行代码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;hello world&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 组件方法 , setState 方法: 内部会进行数据的修改,并会重新执行 render 函数,重新渲染页面</span><br><span class="line">  btnClick() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      message: &quot;Hello React&quot;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.3 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;this.state.message&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;this.btnClick.bind(this)&#125;&gt;修改文本&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h4><ul>
<li><strong>使用箭头函数定义事件回调,在绑定事件时即可直接绑定事件回调</strong>,无需再修改 this 指向</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;当前计数:&quot;,</span><br><span class="line">      counter: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 组件方法</span><br><span class="line">  increment = () =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      counter: this.state.counter + 1</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  decrement = () =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      counter: this.state.counter - 1</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.3 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; message, counter &#125; = this.state</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;message&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h2&gt;&#123;counter&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;this.increment&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;this.decrement&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="方法四"><a href="#方法四" class="headerlink" title="方法四"></a>方法四</h4><ul>
<li>在绑定事件时,<strong>绑定一个箭头函数,在箭头函数中加括号调用需要执行的事件回调</strong> , 注意事件处理函数要加括号调用<ul>
<li>则定义事件回调时,使用 ES6 增强语法定义方法 或者 使用箭头函数定义方法均可</li>
<li>推荐使用,方便传递参数</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;当前计数:&quot;,</span><br><span class="line">      counter: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 组件方法</span><br><span class="line">  increment = () =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      counter: this.state.counter + 1</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  decrement = () =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      counter: this.state.counter - 1</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.3 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; message, counter &#125; = this.state</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;message&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h2&gt;&#123;counter&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button onClick=&#123;this.increment&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; &#123; this.decrement() &#125;&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="事件参数传递"><a href="#事件参数传递" class="headerlink" title="事件参数传递"></a>事件参数传递</h3><ul>
<li>在执行事件函数时，有可能我们需要获取一些参数信息：比如 event 对象、其他参数</li>
<li>情况一：获取 event 对象<ul>
<li>很多时候我们需要拿到 event 对象来做一些事情（比如阻止默认行为）</li>
<li>那么默认情况下，event 对象有被直接传入，函数就可以获取到 event 对象；</li>
</ul>
</li>
<li>情况二：获取更多参数<ul>
<li><strong>有更多参数时，我们最好的方式就是传入一个箭头函数，主动执行的事件函数，并且传入相关的其他参数</strong></li>
<li>极其不推荐通过 bind 修改 this 指向的同时,还传递参数,复杂还容易混乱….(详细参考 JS 高级 bind 修改 this 指向)</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;Hello World&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 组件方法 </span><br><span class="line">  btnClick = (event, name, age) =&gt; &#123;</span><br><span class="line">    console.log(&quot;btnClick&quot;, event, this)</span><br><span class="line">    console.log(&quot;name:&quot;, name, &quot;age:&quot;, age)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.3 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 01. 不传递参数,也会默认传递 event 事件对象 */&#125;</span><br><span class="line">        &lt;button onClick=&#123;this.btnClick&#125;&gt;按钮1&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* 02. event 事件对象的传递, 若实参不写 event , 则第一个形参为 undefined */&#125;</span><br><span class="line">        &lt;button onClick=&#123;(event) =&gt; &#123; this.btnClick(event) &#125;&#125;&gt;按钮2&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* 03. 其他参数的传递 */&#125;</span><br><span class="line">        &lt;button onClick=&#123;(event) =&gt; &#123; this.btnClick(event, &quot;why&quot;, 18) &#125;&#125;&gt;按钮3&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将组件渲染到页面中</span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&quot;#root&quot;))</span><br><span class="line">root.render(&lt;App /&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="事件绑定案例"><a href="#事件绑定案例" class="headerlink" title="事件绑定案例"></a>事件绑定案例</h3><ul>
<li>点击电影列表,选中项变为红色</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      movies: [&quot;星际穿越&quot;, &quot;流浪地球&quot;, &quot;独行月球&quot;, &quot;大话西游&quot;, &quot;火星救援&quot;],</span><br><span class="line">      currentIndex: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 组件方法</span><br><span class="line">  btnClick = (index) =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      currentIndex: index</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.3 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; movies, currentIndex &#125; = this.state</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            movies.map((item, index) =&gt; &#123;</span><br><span class="line">              return (</span><br><span class="line">                &lt;li</span><br><span class="line">                  className=&#123;index === currentIndex ? &quot;active&quot; : &quot;&quot;&#125;</span><br><span class="line">                  key=&#123;index&#125;</span><br><span class="line">                  onClick=&#123;() =&gt; &#123; this.btnClick(index) &#125;&#125;</span><br><span class="line">                &gt;&#123;item&#125;&lt;/li&gt;</span><br><span class="line">              )</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将组件渲染到页面中</span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&quot;#root&quot;))</span><br><span class="line">root.render(&lt;App /&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="React-渲染"><a href="#React-渲染" class="headerlink" title="React 渲染"></a>React 渲染</h2><h3 id="React-条件渲染"><a href="#React-条件渲染" class="headerlink" title="React 条件渲染"></a>React 条件渲染</h3><ul>
<li>某些情况下，界面的内容会根据不同的情况显示不同的内容，或者决定是否渲染某部分内容：<ul>
<li>在 vue 中，我们会通过指令来控制：比如 <code>v-if</code>、<code>v-show</code>；</li>
<li><strong>在 React 中，所有的条件判断都和普通的 JavaScript 代码一致</strong></li>
</ul>
</li>
<li>常见的条件渲染的方式有哪些呢？<ul>
<li>方式一：条件判断语句<ul>
<li>适合逻辑较多的情况</li>
</ul>
</li>
<li>方式二：三元运算符<ul>
<li>适合逻辑比较简单</li>
</ul>
</li>
<li>方式三：与运算符 <code>&amp;&amp;</code><ul>
<li>适合如果条件成立，渲染某一个组件；如果条件不成立，什么内容也不渲染；</li>
</ul>
</li>
<li>v-show 的效果<ul>
<li>主要是控制 display 属性是否为 none</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="if-条件渲染"><a href="#if-条件渲染" class="headerlink" title="if 条件渲染"></a>if 条件渲染</h4><h4 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h4><h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      isReady: true,</span><br><span class="line">      friend: &#123;</span><br><span class="line">        name: &quot;why&quot;,</span><br><span class="line">        age: 18</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    // if 条件判断</span><br><span class="line">    const &#123; isReady, friend &#125; = this.state</span><br><span class="line">    let showElement = null</span><br><span class="line">    if (isReady) &#123;</span><br><span class="line">      showElement = &lt;h2&gt;准备开始&lt;/h2&gt;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      showElement = &lt;h2&gt;提前准备&lt;/h2&gt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 01 if 条件渲染 */&#125;</span><br><span class="line">        &lt;div&gt;&#123;showElement&#125;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* 02 三元运算符 */&#125;</span><br><span class="line">        &lt;div&gt;&#123;isReady ? &lt;h1&gt;开始&lt;/h1&gt; : &lt;h1&gt;等待&lt;/h1&gt;&#125;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* 03 逻辑与运算符  应用场景: 当某一个值有可能为 undefined 时, 使用 &amp;&amp; 进行条件判断 */&#125;</span><br><span class="line">        &lt;div&gt;&#123;friend &amp;&amp; &lt;div&gt;&#123;friend.name + &quot; &quot; + friend.age&#125;&lt;/div&gt;&#125;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将组件渲染到页面中</span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&quot;#root&quot;))</span><br><span class="line">root.render(&lt;App /&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="条件渲染案例"><a href="#条件渲染案例" class="headerlink" title="条件渲染案例"></a>条件渲染案例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;hello world&quot;,</span><br><span class="line">      isShow: true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 组件方法</span><br><span class="line">  btnClick() &#123;</span><br><span class="line">    this.setState(&#123; isShow: !this.state.isShow &#125;) // 状态取反</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.3 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; message, isShow &#125; = this.state</span><br><span class="line"></span><br><span class="line">    let showElement = null</span><br><span class="line">    if (isShow) &#123;</span><br><span class="line">      showElement = &lt;h2&gt;&#123;message&#125;&lt;/h2&gt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; &#123; this.btnClick() &#125;&#125;&gt;切换&lt;/button&gt;</span><br><span class="line">        &#123;/* 01 if 结构实现 */&#125;</span><br><span class="line">        &#123;showElement&#125;</span><br><span class="line"></span><br><span class="line">        &#123;/* 02 逻辑与实现 */&#125;</span><br><span class="line">        &#123;isShow &amp;&amp; &lt;h2&gt;&#123;message&#125;&lt;/h2&gt;&#125;</span><br><span class="line"></span><br><span class="line">        &#123;/* 03 实现类似于 vue 中的 v-show 的效果 */&#125;</span><br><span class="line">        &lt;h2 style=&#123;&#123; display: isShow ? &#x27;block&#x27; : &#x27;none&#x27; &#125;&#125;&gt;你好,李银河&lt;/h2&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将组件渲染到页面中</span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&quot;#root&quot;))</span><br><span class="line">root.render(&lt;App /&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="React-列表渲染"><a href="#React-列表渲染" class="headerlink" title="React 列表渲染"></a>React 列表渲染</h3><h4 id="React-列表渲染-1"><a href="#React-列表渲染-1" class="headerlink" title="React 列表渲染"></a>React 列表渲染</h4><ul>
<li>真实开发中我们会从服务器请求到大量的数据，数据会以列表的形式存储：<ul>
<li>比如歌曲、歌手、排行榜列表的数据；</li>
<li>比如商品、购物车、评论列表的数据；</li>
<li>比如好友消息、动态、联系人列表的数据；</li>
</ul>
</li>
<li>在 React 中并没有像 Vue 模块语法中的 v-for 指令，而且需要我们通过 JavaScript 代码的方式组织数据，转成 JSX：<ul>
<li>很多从 Vue 转型到 React 的同学非常不习惯，认为 Vue 的方式更加的简洁明了；</li>
<li>但是 React 中的 JSX 正是因为和 JavaScript 无缝的衔接，让它可以更加的灵活；</li>
<li>另外我经常会提到 React 是真正可以提高我们编写代码能力的一种方式；</li>
</ul>
</li>
<li>如何展示列表呢？<ul>
<li>在 React 中，展示列表最多的方式就是使用数组的 <strong>map 高阶函数</strong>；</li>
</ul>
</li>
<li>很多时候我们在展示一个数组中的数据之前，需要先对它进行一些处理：<ul>
<li>比如过滤掉一些内容：filter 函数</li>
<li>比如截取数组中的一部分内容：slice 函数</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;电影列表&quot;,</span><br><span class="line">      movies: [&quot;星际穿越&quot;, &quot;盗梦空间&quot;, &quot;大话西游&quot;, &quot;流浪地球&quot;],</span><br><span class="line">      currentIndex: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.2 组件方法</span><br><span class="line">  itemClick(index) &#123;</span><br><span class="line">    this.setState(&#123; currentIndex: index &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 1.3 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; message, movies, currentIndex &#125; = this.state</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;message&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            movies.map((item, index) =&gt; &#123;</span><br><span class="line">              return (</span><br><span class="line">                &lt;li</span><br><span class="line">                  className=&#123;currentIndex === index ? &quot;active&quot; : &quot;&quot;&#125;</span><br><span class="line">                  key=&#123;index&#125;</span><br><span class="line">                  onClick=&#123;() =&gt; &#123; this.itemClick(index) &#125;&#125;</span><br><span class="line">                &gt;</span><br><span class="line">                  &#123;item&#125;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">              )</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将组件渲染到页面中</span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&quot;#root&quot;))</span><br><span class="line">root.render(&lt;App /&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="列表渲染案例"><a href="#列表渲染案例" class="headerlink" title="列表渲染案例"></a>列表渲染案例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;列表渲染案例&quot;,</span><br><span class="line">      students: [</span><br><span class="line">        &#123; id: 111, name: &quot;why&quot;, score: 199 &#125;,</span><br><span class="line">        &#123; id: 112, name: &quot;kobe&quot;, score: 98 &#125;,</span><br><span class="line">        &#123; id: 113, name: &quot;james&quot;, score: 199 &#125;,</span><br><span class="line">        &#123; id: 114, name: &quot;curry&quot;, score: 120 &#125;,</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; message, students &#125; = this.state</span><br><span class="line">    // 对数据进行过滤操作</span><br><span class="line">    const filterStudents = students.filter((item) =&gt; &#123;</span><br><span class="line">      return item.score &gt; 100</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    // 渲染结构</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;message&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            filterStudents.map((item, index) =&gt; &#123;</span><br><span class="line">              return &lt;li key=&#123;item.id&#125;&gt;&#123;`姓名:$&#123;item.name&#125;,成绩:$&#123;item.score&#125;`&#125;&lt;/li&gt;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将组件渲染到页面中</span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&quot;#root&quot;))</span><br><span class="line">root.render(&lt;App /&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="列表中的-key"><a href="#列表中的-key" class="headerlink" title="列表中的 key"></a>列表中的 key</h4><ul>
<li><p>我们会发现在前面的代码中只要展示列表都会报警告：</p>
</li>
<li><p>这个警告是告诉我们需要在列表展示的 jsx 中添加一个 key。</p>
<ul>
<li>key 主要的作用是为了提高 diff 算法时的效率；</li>
<li>这个我们在后续内容中再进行讲解；</li>
</ul>
</li>
</ul>
<h2 id="JSX-原理"><a href="#JSX-原理" class="headerlink" title="JSX 原理"></a>JSX 原理</h2><h3 id="JSX的本质"><a href="#JSX的本质" class="headerlink" title="JSX的本质"></a>JSX的本质</h3><ul>
<li>实际上，jsx 仅仅只是 React.createElement(component, props, …children)  函数的语法糖。<ul>
<li><strong>所有的 jsx 最终都会被转换成 React.createElement 的函数调用</strong>。</li>
</ul>
</li>
<li>createElement 需要传递三个参数：<ul>
<li>参数一：type<ul>
<li>当前 ReactElement 的类型；</li>
<li>如果是标签元素，那么就使用字符串表示 “div”；</li>
<li>如果是组件元素，那么就直接使用组件的名称；</li>
</ul>
</li>
<li>参数二：config 对象,即创建的元素的属性和属性值 (没有属性就写 null ) <ul>
<li>所有 jsx 中的属性都在 config 中以对象的属性和值的形式存储；</li>
<li>比如传入 className 作为元素的 class；</li>
</ul>
</li>
<li>参数三：children<ul>
<li>存放在标签中的内容，以 children 数组的方式进行存储；</li>
<li>当然，如果是多个元素呢？React 内部有对它们进行处理，处理的过程见源码</li>
</ul>
</li>
</ul>
</li>
<li>我们知道默认 jsx 是通过 babel 帮我们进行语法转换的，所以我们之前写的 jsx 代码都需要依赖 babel。</li>
<li>可以在 babel 的官网中快速查看转换的过程：<a target="_blank" rel="noopener" href="https://babeljs.io/repl/#?presets=react">https://babeljs.io/repl/#?presets=react</a></li>
</ul>
<h3 id="直接编写-JSX"><a href="#直接编写-JSX" class="headerlink" title="直接编写 JSX"></a>直接编写 JSX</h3><ul>
<li>我们自己来编写 React.createElement 代码：<ul>
<li>我们就没有通过 jsx 来书写了，界面依然是可以正常的渲染。</li>
<li>另外，在这样的情况下，你还需要 babel 相关的内容吗？不需要了<ul>
<li>所以，<code>type=&quot;text/babel&quot;</code> 可以被我们删除掉了；</li>
<li>所以，<code>&lt;script src=&quot;../react/babel.min.js&quot;&gt;&lt;/script&gt;</code>可以被我们删除掉了；</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="虚拟DOM的创建过程"><a href="#虚拟DOM的创建过程" class="headerlink" title="虚拟DOM的创建过程"></a>虚拟DOM的创建过程</h2><ul>
<li><p>我们通过 React.createElement 最终创建出来一个 ReactElement 对象：</p>
</li>
<li><p>这个 ReactElement 对象是什么作用呢？React 为什么要创建它呢？</p>
<ul>
<li>原因是 React 利用 ReactElement 对象组成了一个 JavaScript 的对象树；</li>
<li>JavaScript 的对象树就是虚拟 DOM（Virtual DOM）；</li>
</ul>
</li>
<li><p>如何查看 ReactElement 的树结构呢？</p>
<ul>
<li>我们可以将之前的 jsx 返回结果进行打印；</li>
<li>注意下面代码中我打 jsx 的打印；</li>
</ul>
</li>
<li><p>而 ReactElement 最终形成的树结构就是 Virtual DOM；</p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/11e3f9b5afb749298341563ae5e2c36c" alt="1663997001745"></p>
<h2 id="声明式编程-1"><a href="#声明式编程-1" class="headerlink" title="声明式编程"></a>声明式编程</h2><ul>
<li>虚拟 DOM 帮助我们从命令式编程转到了声明式编程的模式</li>
<li>React 官方的说法：Virtual DOM 是一种编程理念。<ul>
<li>在这个理念中，UI 以一种理想化或者说虚拟化的方式保存在内存中，并且它是一个相对简单的 JavaScript 对象</li>
<li>我们可以<strong>通过 ReactDOM.render 让 虚拟 DOM 和 真实 DOM 同步起来，这个过程中叫做协调</strong>（Reconciliation）；</li>
</ul>
</li>
<li>这种编程的方式赋予了 React 声明式的 API ：<ul>
<li>你只需要告诉 React 希望让 UI 是什么状态；</li>
<li>React 来确保 DOM 和这些状态是匹配的；</li>
<li>你不需要直接进行 DOM 操作，就可以从手动更改 DOM、属性操作、事件处理中解放出来；</li>
</ul>
</li>
<li>关于虚拟 DOM 的一些其他内容，在后续的学习中还会再次讲到；</li>
</ul>
<h2 id="购物车案例练习"><a href="#购物车案例练习" class="headerlink" title="购物车案例练习"></a>购物车案例练习</h2><ul>
<li>1 在界面上以表格的形式，显示一些书籍的数据；</li>
<li>2 在底部显示书籍的总价格；</li>
<li>3 点击 + 或者 - 可以增加或减少书籍数量（如果为 1，那么不能继续 - ）；</li>
<li>4 点击移除按钮，可以将书籍移除（当所有的书籍移除完毕时，显示：购物车为空）；</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/973d8c51025e4450b67b8801605f9686" alt="1663998003145"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../lib/react.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../lib/react-dom.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../lib/babel.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./data.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./format.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">// 定义 App 根组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  // 1.1 组件数据</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super()</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      books: books</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 组件方法</span><br><span class="line">  // 总价格</span><br><span class="line">  getTotalPrice() &#123;</span><br><span class="line">    const &#123; books &#125; = this.state</span><br><span class="line">    // 计算总价格,方式一</span><br><span class="line">    // let totalPrice = 0</span><br><span class="line">    // for (let i = 0; i &lt; books.length; i++) &#123;</span><br><span class="line">    //   const book = books[i]</span><br><span class="line">    //   totalPrice += book.price * book.count</span><br><span class="line">    // &#125;</span><br><span class="line">    // 方式二:</span><br><span class="line">    let totalPrice = books.reduce((preValue, item) =&gt; &#123;</span><br><span class="line">      return preValue + item.count * item.price</span><br><span class="line">    &#125;, 0)</span><br><span class="line">    return totalPrice</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 加减按钮的点击</span><br><span class="line">  // increment = (index) =&gt; &#123;</span><br><span class="line">  //   const newBooks = [...this.state.books]</span><br><span class="line">  //   newBooks[index].count += 1</span><br><span class="line">  //   this.setState(&#123; books: newBooks &#125;)</span><br><span class="line">  // &#125;</span><br><span class="line">  // decrement = (index) =&gt; &#123;</span><br><span class="line">  //   const newBooks = [...this.state.books]</span><br><span class="line">  //   newBooks[index].count -= 1</span><br><span class="line">  //   this.setState(&#123; books: newBooks &#125;)</span><br><span class="line">  // &#125;</span><br><span class="line">  changeCount = (index, count) =&gt; &#123;</span><br><span class="line">    const newBooks = [...this.state.books]</span><br><span class="line">    newBooks[index].count += count</span><br><span class="line">    this.setState(&#123; books: newBooks &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 删除按钮的回调</span><br><span class="line">  removeItem = (index) =&gt; &#123;</span><br><span class="line">    const newBooks = [...this.state.books]</span><br><span class="line">    newBooks.splice(index, 1)</span><br><span class="line">    this.setState(&#123; books: newBooks &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 渲染购物车列表</span><br><span class="line">  renderBookList = () =&gt; &#123;</span><br><span class="line">    const &#123; books &#125; = this.state</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;table&gt;</span><br><span class="line">          &lt;thead&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;th&gt;序号&lt;/th&gt;</span><br><span class="line">              &lt;th&gt;书籍名称&lt;/th&gt;</span><br><span class="line">              &lt;th&gt;出版日期&lt;/th&gt;</span><br><span class="line">              &lt;th&gt;价格&lt;/th&gt;</span><br><span class="line">              &lt;th&gt;购买数量&lt;/th&gt;</span><br><span class="line">              &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">          &lt;/thead&gt;</span><br><span class="line">          &lt;tbody&gt;</span><br><span class="line">            &#123;</span><br><span class="line">              books.map((item, index) =&gt; &#123;</span><br><span class="line">                return (</span><br><span class="line">                  &lt;tr key=&#123;item.id&#125;&gt;</span><br><span class="line">                    &lt;td&gt;&#123;index + 1&#125;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&#123;item.name&#125;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&#123;item.date&#125;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&#123;formatPrice(item.price)&#125;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;</span><br><span class="line">                      &lt;button disabled=&#123;item.count &lt;= 1&#125; onClick=&#123;() =&gt; &#123; this.changeCount(index, -1) &#125;&#125;&gt;-&lt;/button&gt;</span><br><span class="line">                      &#123;item.count&#125;</span><br><span class="line">                      &lt;button onClick=&#123;() =&gt; &#123; this.changeCount(index, 1) &#125;&#125;&gt;+&lt;/button&gt;</span><br><span class="line">                    &lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;button onClick=&#123;() =&gt; &#123; this.removeItem(index) &#125;&#125;&gt;删除&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">                  &lt;/tr&gt;</span><br><span class="line">                )</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">        &lt;h2&gt;总价格:&#123;formatPrice(this.getTotalPrice())&#125;&lt;/h2&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 渲染购物车为空时的结构</span><br><span class="line">  renderBookEmpty = () =&gt; &#123;</span><br><span class="line">    return &lt;div&gt;&lt;h2&gt;购物车数据为空,请添加书籍&lt;/h2&gt;&lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 渲染内容</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; books &#125; = this.state</span><br><span class="line">    return books.length ? this.renderBookList() : this.renderBookEmpty()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将组件渲染到页面中</span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&quot;#root&quot;))</span><br><span class="line">root.render(&lt;App /&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>format.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">formatPrice</span>(<span class="params">price</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;¥&#x27;</span> + <span class="title class_">Number</span>(price).<span class="title function_">toFixed</span>(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>data.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> books = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;《算法导论》&#x27;</span>,</span><br><span class="line">    <span class="attr">date</span>: <span class="string">&#x27;2006-9&#x27;</span>,</span><br><span class="line">    <span class="attr">price</span>: <span class="number">85.00</span>,</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;《UNIX编程艺术》&#x27;</span>,</span><br><span class="line">    <span class="attr">date</span>: <span class="string">&#x27;2006-2&#x27;</span>,</span><br><span class="line">    <span class="attr">price</span>: <span class="number">59.00</span>,</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;《编程珠玑》&#x27;</span>,</span><br><span class="line">    <span class="attr">date</span>: <span class="string">&#x27;2008-10&#x27;</span>,</span><br><span class="line">    <span class="attr">price</span>: <span class="number">39.00</span>,</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;《代码大全》&#x27;</span>,</span><br><span class="line">    <span class="attr">date</span>: <span class="string">&#x27;2006-3&#x27;</span>,</span><br><span class="line">    <span class="attr">price</span>: <span class="number">128.00</span>,</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/* CSS */</span> </span><br><span class="line"><span class="selector-tag">table</span> &#123;</span><br><span class="line">    <span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">thead</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">td</span>,</span><br><span class="line">  <span class="selector-tag">th</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#aaa</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="React-脚手架"><a href="#React-脚手架" class="headerlink" title="React 脚手架"></a>React 脚手架</h2><h3 id="前端工程的复杂化"><a href="#前端工程的复杂化" class="headerlink" title="前端工程的复杂化"></a>前端工程的复杂化</h3><ul>
<li>如果我们只是开发几个小的 demo 程序，那么永远不需要考虑一些复杂的问题：<ul>
<li><strong>比如目录结构如何组织划分；</strong></li>
<li><strong>比如如何管理文件之间的相互依赖；</strong></li>
<li><strong>比如如何管理第三方模块的依赖；</strong></li>
<li><strong>比如项目发布前如何压缩、打包项目；</strong></li>
<li>等等…</li>
</ul>
</li>
<li>现代的前端项目已经越来越复杂了：<ul>
<li>不会再是在 HTML 中引入几个 css 文件，引入几个编写的 js 文件或者第三方的 js 文件这么简单；</li>
<li>比如 css 可能是使用 less、sass 等预处理器进行编写，我们需要将它们转成普通的 css 才能被浏览器解析；</li>
<li>比如 JavaScript 代码不再只是编写在几个文件中，而是通过模块化的方式，被组成在成百上千个文件中，我们需要通过模块化的技术来管理它们之间的相互依赖；</li>
<li>比如项目需要依赖很多的第三方库，如何更好的管理它们（比如管理它们的依赖、版本升级等）；</li>
</ul>
</li>
<li>为了解决上面这些问题，我们需要再去学习一些工具：<ul>
<li>比如 babel、webpack、gulp，配置它们转换规则、打包依赖、热更新等等一些的内容；</li>
<li>脚手架的出现，就是帮助我们解决这一系列问题的；</li>
</ul>
</li>
</ul>
<h3 id="什么是脚手架"><a href="#什么是脚手架" class="headerlink" title="什么是脚手架"></a>什么是脚手架</h3><ul>
<li>传统的脚手架指的是建筑学的一种结构：在搭建楼房、建筑物时，临时搭建出来的一个框架；</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/5227295ac95641789bd6858014111def" alt="1664621537937"></p>
<ul>
<li>编程中提到的脚手架（Scaffold），其实<strong>是一种工具，帮我们可以快速生成项目的工程化结构</strong><ul>
<li>每个项目作出完成的效果不同，但是它们的<strong>基本工程化</strong>结构是相似的；</li>
<li>既然相似，就没有必要每次都从零开始搭建，完全可以使用一些工具，帮助我们生产基本的工程化模板；</li>
<li>不同的项目，在这个模板的基础之上进行项目开发或者进行一些配置的简单修改即可；</li>
<li>这样也可以间接保证项目的基本机构一致性，<strong>方便后期的维护</strong>；</li>
</ul>
</li>
<li>总结：脚手架让项目从搭建到开发，再到部署，整个流程变得快速和便捷；</li>
</ul>
<h3 id="前端脚手架"><a href="#前端脚手架" class="headerlink" title="前端脚手架"></a>前端脚手架</h3><ul>
<li>对于现在比较流行的三大框架都有属于自己的脚手架：<ul>
<li>Vue 的脚手架：**@vue&#x2F;cli**</li>
<li>Angular 的脚手架：@angular&#x2F;cli</li>
<li>React 的脚手架：<strong>create-react-app</strong></li>
</ul>
</li>
<li><strong>它们的作用都是帮助我们生成一个通用的目录结构，并且已经将我们所需的工程环境配置好</strong></li>
<li>使用这些脚手架需要依赖什么呢？<ul>
<li>目前这些脚手架都是使用 node 编写的，并且都是基于 webpack 的；</li>
<li>所以我们必须在自己的电脑上安装 node 环境；</li>
</ul>
</li>
<li>这里我们主要是学习 React，所以我们以 React 的脚手架工具：create-react-app 作为讲解；</li>
</ul>
<h3 id="安装-node"><a href="#安装-node" class="headerlink" title="安装 node"></a>安装 node</h3><ul>
<li>React 脚手架本身需要依赖 node，所以我们需要安装 node 环境：<ul>
<li>无论是 windows 还是 Mac OS，都可以通过 node 官网直接下载；</li>
<li>官网地址：<a target="_blank" rel="noopener" href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></li>
<li>注意：这里推荐大家下载 LTS（Long-term support ）版本，是长期支持版本，会比较稳定；</li>
</ul>
</li>
<li>下载后，双击安装即可：<ul>
<li>安装过程中，会自动配置环境变量；</li>
<li>安装时，会同时帮助我们安装 npm 管理工具；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/2a347ba6daae4150aaa9d11941648953" alt="1664631012799"></p>
<h3 id="创建-React-项目"><a href="#创建-React-项目" class="headerlink" title="创建 React 项目"></a>创建 React 项目</h3><ul>
<li><p>安装脚手架 : <strong>npm install create-react-app -g</strong></p>
</li>
<li><p>现在，我们就可以通过脚手架来创建 React 项目了。</p>
</li>
<li><p>创建 React 项目的命令如下：</p>
<ul>
<li><strong>create-react-app 项目名称</strong>  或者 <strong>npx create-react-app 项目名称</strong> , 后者无需安装脚手架, npx 指令会联网调用最新脚手架版本创建项目<ul>
<li>注意：<strong>项目名称不能包含大写字母</strong></li>
<li>另外还有更多创建项目的方式，可以参考 GitHub 的 readme</li>
</ul>
</li>
</ul>
</li>
<li><p>创建完成后，进入对应的目录,执行命令,就可以将项目跑起来：</p>
<ul>
<li><strong>cd 01-test-react</strong> </li>
<li>**npm run start **</li>
</ul>
</li>
</ul>
<h3 id="目录结构分析"><a href="#目录结构分析" class="headerlink" title="目录结构分析"></a>目录结构分析</h3><p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/85ebb96e3741434cb1a7abdb3e4e4240" alt="1664631059744"></p>
<h3 id="了解-PWA"><a href="#了解-PWA" class="headerlink" title="了解 PWA"></a>了解 PWA</h3><ul>
<li>整个目录结构都非常好理解，只是有一个 PWA 相关的概念：<ul>
<li>PWA 全称 Progressive Web App，即<strong>渐进式 WEB 应用</strong>；</li>
<li>一个 PWA 应用首先是一个网页, 可以通过 Web 技术编写出一个网页应用；</li>
<li>随后添加上 App Manifest 和 Service Worker 来实现 PWA 的安装和离线等功能；</li>
<li>这种 Web 存在的形式，我们也称之为是 Web App；</li>
</ul>
</li>
<li>PWA 解决了哪些问题呢？<ul>
<li>可以添加至主屏幕，点击主屏幕图标可以实现启动动画以及隐藏地址栏；</li>
<li>实现离线缓存功能，即使用户手机没有网络，依然可以使用一些离线功能；</li>
<li>实现了消息推送；</li>
<li>等等一系列类似于 Native App 相关的功能；</li>
</ul>
</li>
<li>更多 PWA 相关的知识，可以自行去学习更多；<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps">https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps</a></li>
</ul>
</li>
</ul>
<h3 id="脚手架中的-Webpack"><a href="#脚手架中的-Webpack" class="headerlink" title="脚手架中的 Webpack"></a>脚手架中的 Webpack</h3><ul>
<li>React 脚手架默认是基于 Webpack 来开发的；</li>
<li>但是，很奇怪：我们并没有在目录结构中看到任何 Webpack 相关的内容？<ul>
<li>原因是 React 脚手架将 Webpack 相关的配置隐藏起来了（其实从 Vue CLI3 开始，也是进行了隐藏）；</li>
</ul>
</li>
<li>如果我们希望看到 Webpack 的配置信息，应该怎么来做呢？<ul>
<li>我们可以执行一个 <strong>package.json</strong> 文件中的一个脚本：<code>&quot;eject&quot;: &quot;react-scripts eject&quot;</code>  , 执行指令 : <strong>npm eject</strong></li>
<li><strong>这个操作是不可逆的, 操作需谨慎</strong>，所以在执行过程中会给与我们提示；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/6cfb19ff40e64c0fa99ceb95b2dfe73e" alt="1664631217363"></p>
<h3 id="文件结构删除"><a href="#文件结构删除" class="headerlink" title="文件结构删除"></a>文件结构删除</h3><ul>
<li>通过脚手架创建完项目，很多同学还是会感觉目录结构过于复杂，所以我打算从零带着大家来编写代码。</li>
<li>我们先将不需要的文件统统删掉：<ul>
<li>01 将 src 下的所有文件都删除</li>
<li>02 将 public 文件下除了 favicon.ico 和 index.html 之外的文件都删除掉</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/71ca929524544a92949a0b7cfe65acee" alt="1664631300449"></p>
<ul>
<li>如果删除了目录中的 <code>./pulic/manifest.json</code> 文件,运行时控制台报错<ul>
<li>在 <code>./public/index.html</code> 中将 <code>&lt;link *rel*=&quot;manifest&quot; *href*=&quot;%PUBLIC_URL%/manifest.json&quot; /&gt;</code> 删掉即可</li>
</ul>
</li>
</ul>
<h3 id="开始书写代码"><a href="#开始书写代码" class="headerlink" title="开始书写代码"></a>开始书写代码</h3><ul>
<li>在 src 目录下，创建一个 index.js 文件，因为这是 webpack 打包的入口。</li>
<li>在 index.js 中开始编写 React 代码：<ul>
<li>我们会发现和写的代码是逻辑是一致的；</li>
<li>只是在模块化开发中，我们需要手动的来导入 React、ReactDOM，因为它们都是在我们安装的模块中；</li>
</ul>
</li>
<li>如果我们不希望直接在 root.render 中编写过多的代码，就可以单独抽取一个组件 App.js：</li>
</ul>
<p><strong>index.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import ReactDOM from &#x27;react-dom/client&#x27;</span><br><span class="line"></span><br><span class="line">import App from &#x27;./App.jsx&#x27;</span><br><span class="line"></span><br><span class="line">const root = ReactDOM.createRoot(document.querySelector(&#x27;#root&#x27;))</span><br><span class="line">root.render(&lt;App&gt;&lt;/App&gt;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HelloWorld</span> <span class="keyword">from</span> <span class="string">&#x27;./Components/HelloWorld.jsx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;Hello React&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; message &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HelloWorld</span>&gt;</span><span class="tag">&lt;/<span class="name">HelloWorld</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>.&#x2F;Components&#x2F;HelloWorld.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HelloWorld</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好,师姐&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; message &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HelloWorld</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="组件化开发-2"><a href="#组件化开发-2" class="headerlink" title="组件化开发"></a>组件化开发</h2><h3 id="什么是组件化开发"><a href="#什么是组件化开发" class="headerlink" title="什么是组件化开发"></a>什么是组件化开发</h3><ul>
<li>组件化是一种分而治之的思想：<ul>
<li>如果我们将一个页面中所有的处理逻辑全部放在一起，处理起来就会变得非常复杂，而且不利于后续的管理以及扩展。</li>
<li>但如果，我们讲一个页面拆分成一个个小的功能块，每个功能块完成属于自己这部分独立的功能，那么之后整个页面的管理和维护就变得非常容易了。</li>
</ul>
</li>
<li>我们需要通过组件化的思想来思考整个应用程序：<ul>
<li>我们将一个完整的页面分成很多个组件；</li>
<li>每个组件都用于实现页面的一个功能块；</li>
<li>而每一个组件又可以进行细分；</li>
<li>而组件本身又可以在多个地方进行复用；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/869f11d0aa284123a31d17910c64e22a" alt="1664707966668"></p>
<h3 id="React的组件化"><a href="#React的组件化" class="headerlink" title="React的组件化"></a>React的组件化</h3><ul>
<li>组件化是 React 的核心思想，也是我们后续课程的重点，前面我们封装的 App 本身就是一个组件：<ul>
<li>组件化提供了一种抽象，让我们可以开发出一个个独立可复用的小组件来构造我们的应用。</li>
<li>任何的应用都会被抽象成一颗组件树。</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/d96fc10c433f478f8f6965f4e923401e" alt="1664708003911"></p>
<h3 id="React组件的分类"><a href="#React组件的分类" class="headerlink" title="React组件的分类"></a>React组件的分类</h3><ul>
<li><p>组件化思想的应用：</p>
<ul>
<li>有了组件化的思想，我们在之后的开发中就要充分的利用它。</li>
<li>尽可能的将页面拆分成一个个小的、可复用的组件。</li>
<li>这样让我们的代码更加方便组织和管理，并且扩展性也更强。</li>
</ul>
</li>
<li><p>React 的组件相对于 Vue 更加的灵活和多样，按照不同的方式可以分成很多类组件：</p>
<ul>
<li><strong>根据组件的定义方式，可以分为：函数组件 (Functional Component ) 和类组件 (Class Component)；</strong></li>
<li><strong>根据组件内部是否有状态需要维护，可以分成：无状态组件 (Stateless Component ) 和有状态组件 (Stateful Component)；</strong></li>
<li><strong>根据组件的不同职责，可以分成：展示型组件 (Presentational Component) 和容器型组件 (Container Component)；</strong></li>
</ul>
</li>
<li><p>这些概念有很多重叠，但是他们最主要是关注数据逻辑和 UI 展示的分离：</p>
<ul>
<li><strong>函数组件、无状态组件、展示型组件主要关注 UI 的展示；</strong></li>
<li><strong>类组件、有状态组件、容器型组件主要关注数据逻辑；</strong></li>
</ul>
</li>
<li><p>当然还有很多组件的其他概念：比如异步组件、高阶组件等，我们后续再学习。</p>
</li>
</ul>
<h3 id="类组件"><a href="#类组件" class="headerlink" title="类组件"></a>类组件</h3><h4 id="类组件-1"><a href="#类组件-1" class="headerlink" title="类组件"></a>类组件</h4><ul>
<li>类组件的定义有如下要求：<ul>
<li><strong>组件的名称是大写字符开头（无论类组件还是函数组件）</strong></li>
<li><strong>类组件需要继承自 React.Component</strong></li>
<li><strong>类组件必须实现 render 函数</strong></li>
</ul>
</li>
<li>在 ES6 之前，可以通过 create-react-class 模块来定义类组件，但是目前官网建议我们使用 ES6 的 class 类定义。</li>
<li>使用 class 定义一个组件：<ul>
<li>constructor 是可选的，我们通常在 constructor 中初始化一些数据；</li>
<li>this.state 中维护的就是我们组件内部的数据；</li>
<li>render() 方法是 class 组件中唯一必须实现的方法；</li>
</ul>
</li>
</ul>
<p><strong>.&#x2F;App.js</strong>  定义一个类组件</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义并分别暴露组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好师姐&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 从 state 中解构出需要的数据</span></span><br><span class="line">    <span class="keyword">const</span> &#123; message &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="comment">// 将数据渲染到页面</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认暴露组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>index.js</strong> 引入 App.js 类组件并使用,无需注册</p>
<ul>
<li><strong>App.js</strong> 即为最大的容器组件</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="render函数的返回值"><a href="#render函数的返回值" class="headerlink" title="render函数的返回值"></a>render函数的返回值</h4><ul>
<li>当 render 被调用时，它会检查 this.props 和 this.state 的变化并返回以下类型之一：<ul>
<li><strong>React 元素</strong>：<ul>
<li>通常通过 JSX 创建。</li>
<li>例如，<code>&lt;div /&gt;</code> 会被 React 渲染为 DOM 节点，<code>&lt;MyComponent /&gt; </code>会被 React 渲染为自定义组件；</li>
<li>无论是 <code>&lt;div /&gt; </code>还是<code>&lt;MyComponent /&gt;</code>均为 React 元素。</li>
</ul>
</li>
<li><strong>数组或 fragments</strong>：使得 render 方法可以返回多个元素。</li>
<li><strong>Portals</strong>：可以渲染子节点到不同的 DOM 子树中。</li>
<li><strong>字符串或数值类型</strong>：它们在 DOM 中会被渲染为文本节点</li>
<li><strong>布尔类型或 null</strong>：什么都不渲染。</li>
</ul>
</li>
</ul>
<h3 id="函数组件"><a href="#函数组件" class="headerlink" title="函数组件"></a>函数组件</h3><ul>
<li>函数组件是使用 function 来进行定义的函数，只是这个函数会返回和类组件中 render 函数返回一样的内容。</li>
<li>函数组件有自己的特点（当然，后面我们会讲 hooks，就不一样了）：<ul>
<li><strong>没有生命周期，也会被更新并挂载，但是没有生命周期函数；</strong></li>
<li><strong>this 关键字不能指向组件实例（因为没有组件实例）；</strong></li>
<li><strong>没有内部状态（state）；</strong></li>
</ul>
</li>
<li>我们来定义一个函数组件：</li>
</ul>
<p><strong>.&#x2F;Components&#x2F;HelloReact.jsx</strong>  定义一个函数式组件 , 返回值跟 类组件的 render 函数的返回值一样</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数式组件</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">HelloReact</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>HelloReact,师姐,你好<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HelloReact</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>App.jsx</strong> 引入函数式组件并使用:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HelloReact</span> <span class="keyword">from</span> <span class="string">&#x27;./Components/HelloReact.jsx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;Hello React&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; message &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HelloReact</span>&gt;</span><span class="tag">&lt;/<span class="name">HelloReact</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>在前面的学习中，我们主要讲解类组件，后面学习 Hooks 时，会针对函数式组件进行更多的学习。</li>
</ul>
<h2 id="组件生命周期"><a href="#组件生命周期" class="headerlink" title="组件生命周期"></a>组件生命周期</h2><h3 id="认识生命周期"><a href="#认识生命周期" class="headerlink" title="认识生命周期"></a>认识生命周期</h3><ul>
<li>很多的事物都有从创建到销毁的整个过程，这个过程称之为是生命周期；</li>
<li>React 组件也有自己的生命周期，了解组件的<strong>生命周期可以让我们在最合适的地方完成自己想要的功能</strong>；</li>
<li>生命周期和生命周期函数的关系：</li>
<li>生命周期是一个抽象的概念，在生命周期的整个过程，分成了很多个阶段；<ul>
<li>比如<strong>装载阶段（Mount）</strong>，组件第一次在 DOM 树中被渲染的过程；</li>
<li>比如<strong>更新过程（Update）</strong>，组件状态发生变化，重新更新渲染的过程；</li>
<li>比如<strong>卸载过程（Unmount）</strong>，组件从 DOM 树中被移除的过程；</li>
</ul>
</li>
<li>React 内部为了告诉我们当前处于哪些阶段，会对我们组件内部实现的某些函数进行回调，这些函数就是生命周期函数：<ul>
<li>比如实现 <strong>componentDidMount 函数：组件已经挂载到 DOM 上时，就会回调；</strong></li>
<li>比如实现 <strong>componentDidUpdate 函数：组件已经发生了更新时，就会回调；</strong></li>
<li>比如实现 <strong>componentWillUnmount 函数：组件即将被移除时，就会回调；</strong></li>
<li>我们可以在这些回调函数中编写自己的逻辑代码，来完成自己的需求功能；</li>
</ul>
</li>
<li>我们谈 React 生命周期时，主要谈的类组件的生命周期，因为函数式组件是没有生命周期函数的；（后面我们可以通过 hooks 来模拟一些生命周期的回调）</li>
</ul>
<h3 id="生命周期解析"><a href="#生命周期解析" class="headerlink" title="生命周期解析"></a>生命周期解析</h3><ul>
<li>我们先来学习一下最基础、最常用的生命周期函数：</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/b6c7c453adb74d9da427ae067752085d" alt="1664708339180"></p>
<h3 id="生命周期函数"><a href="#生命周期函数" class="headerlink" title="生命周期函数"></a>生命周期函数</h3><h4 id="构造器"><a href="#构造器" class="headerlink" title="构造器"></a>构造器</h4><h4 id="render"><a href="#render" class="headerlink" title="render"></a>render</h4><h4 id="组件挂载"><a href="#组件挂载" class="headerlink" title="组件挂载"></a>组件挂载</h4><ul>
<li>Constructor<ul>
<li>如果不初始化 state 或不进行方法绑定，则不需要为 React 组件实现构造函数。</li>
<li>constructor 中通常只做两件事情：<ul>
<li>通过给 this.state 赋值对象来初始化内部的 state；</li>
<li>为事件绑定实例（this）；</li>
</ul>
</li>
</ul>
</li>
<li>componentDidMount <ul>
<li>componentDidMount() 会在组件挂载后（插入 DOM 树中）立即调用。</li>
<li>componentDidMount 中通常进行哪里操作呢？<ul>
<li>依赖于 DOM 的操作可以在这里进行；</li>
<li>在此处发送网络请求就最好的地方；（官方建议）</li>
<li>可以在此处添加一些订阅（会在 componentWillUnmount 取消订阅）；</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>任意组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义并分别暴露组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="comment">// 1. 构造器 constructor 会最先被调用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;01 我是构造器中的执行的~&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好师姐&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 2. render 方法紧随其后调用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;02 我是 render 方法中执行的~&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> &#123; message &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 组件被渲染到 DOM 时 , 即被挂载到 DOM 时,该生命周期函数被调用</span></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;03 componentDidMount&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认暴露组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="组件更新"><a href="#组件更新" class="headerlink" title="组件更新"></a>组件更新</h4><ul>
<li>componentDidUpdate<ul>
<li>componentDidUpdate() 会在更新后会被立即调用，首次渲染不会执行此方法。</li>
<li>当组件更新后，可以在此处对 DOM 进行操作；</li>
<li>如果你对更新前后的 props 进行了比较，也可以选择在此处进行网络请求；（例如，当 props 未发生变化时，则不会执行网络请求）。</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义并分别暴露组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="comment">// 1. 构造器会最先被调用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;01 我是构造器中的执行的~&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好师姐&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  btnClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好,世界&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 2. render 方法紧随其后调用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;02 我是 render 方法中执行的~&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> &#123; message &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.btnClick()</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          &#123;message&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 组件被渲染到 DOM 时 , 即被挂载到 DOM 时,该生命周期函数被调用</span></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;03 componentDidMount&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. 组件的 DOM 更新时被调用, 数据更新,页面重新渲染, render 也会在该生命周期函数之前调用一次</span></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;04 componentDidUpdate&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认暴露组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="组件卸载"><a href="#组件卸载" class="headerlink" title="组件卸载"></a>组件卸载</h4><ul>
<li>componentWillUnmount<ul>
<li>componentWillUnmount() 会在组件卸载及销毁之前直接调用。</li>
<li>在此方法中执行必要的清理操作；</li>
<li>例如，清除 timer，取消网络请求或清除在 componentDidMount() 中创建的订阅等；</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5. 组件从 DOM 中卸载时调用 , 那个组件被卸载,该生命周期函数就写在那个组件中...</span></span><br><span class="line"><span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentWillUnmount&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="不常用的生命周期"><a href="#不常用的生命周期" class="headerlink" title="不常用的生命周期"></a>不常用的生命周期</h3><ul>
<li>除了上面介绍的生命周期函数之外，还有一些不常用的生命周期函数：<ul>
<li>getDerivedStateFromProps：state 的值在任何时候都依赖于 props 时使用；该方法返回一个对象来更新 state；</li>
<li>getSnapshotBeforeUpdate：在 React 更新 DOM 之前回调的一个函数，可以获取 DOM 更新前的一些信息（比如说滚动位置）；</li>
<li>shouldComponentUpdate：该生命周期函数很常用，但是我们等待讲性能优化时再来详细讲解；</li>
</ul>
</li>
<li>另外，React 中还提供了一些过期的生命周期函数，这些函数已经不推荐使用。</li>
<li>更详细的生命周期相关的内容，可以参考官网：<a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/docs/react-component.html">https://zh-hans.reactjs.org/docs/react-component.html</a></li>
<li>或者可以查阅 : <a target="_blank" rel="noopener" href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/">https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/</a></li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/d5d7ea721f634a7e81175dab0b5c28f7" alt="1664708543095"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过返回值 true/false ,决定数据更新后是否要重新渲染页面</span></span><br><span class="line"><span class="title function_">shouldComponentUpdate</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="组件间通信"><a href="#组件间通信" class="headerlink" title="组件间通信"></a>组件间通信</h2><h3 id="组件的嵌套"><a href="#组件的嵌套" class="headerlink" title="组件的嵌套"></a>组件的嵌套</h3><ul>
<li>组件之间存在嵌套关系：<ul>
<li>在之前的案例中，我们只是创建了一个组件 App；</li>
<li>如果我们一个应用程序将所有的逻辑都放在一个组件中，那么这个组件就会变成非常的臃肿和难以维护；</li>
<li>所以组件化的核心思想应该是对组件进行拆分，拆分成一个个小的组件；</li>
<li>再将这些组件组合嵌套在一起，最终形成我们的应用程序；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/27472608739b400292645cd02ea51aa5" alt="1664708619829"></p>
<ul>
<li>上面的嵌套逻辑如下，它们存在如下关系：<ul>
<li>App 组件是 Header、Main、Footer 组件的父组件；<ul>
<li>Main 组件是 Banner、ProductList 组件的父组件；</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="认识组件间通信"><a href="#认识组件间通信" class="headerlink" title="认识组件间通信"></a>认识组件间通信</h3><ul>
<li><p>在开发过程中，我们会经常遇到需要组件之间相互进行通信：</p>
<ul>
<li>比如 App 可能使用了多个 Header，每个地方的 Header 展示的内容不同，那么我们就需要使用者传递给 Header 一些数据，让其进行展示；</li>
<li>又比如我们在 Main 中一次性请求了 Banner 数据和 ProductList 数据，那么就需要传递给他们来进行展示；</li>
<li>也可能是子组件中发生了事件，需要由父组件来完成某些操作，那就需要子组件向父组件传递事件；</li>
<li>总之，在一个 React 项目中，组件之间的通信是非常重要的环节；</li>
</ul>
</li>
<li><p>父组件在展示子组件，可能会传递一些数据给子组件：</p>
<ul>
<li>父组件通过 属性&#x3D;值 的形式来传递给子组件数据；</li>
<li>子组件通过 props 参数获取父组件传递过来的数据；</li>
</ul>
</li>
<li><p>组件间通信父传子</p>
</li>
</ul>
<p>父组件 :  <strong>Main.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MainBanner</span> <span class="keyword">from</span> <span class="string">&#x27;./MainBanner&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MainProductList</span> <span class="keyword">from</span> <span class="string">&#x27;./MainProductList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Main</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="comment">// 1. 准备的数据</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">banner</span>: [<span class="string">&#x27;新歌曲&#x27;</span>, <span class="string">&#x27;新MV&#x27;</span>, <span class="string">&#x27;新歌单&#x27;</span>],</span><br><span class="line">      <span class="attr">productList</span>: [<span class="string">&#x27;推荐商品&#x27;</span>, <span class="string">&#x27;热门商品&#x27;</span>, <span class="string">&#x27;流行商品&#x27;</span>],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Main<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 2. 将数据传递给子组件 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MainBanner</span> <span class="attr">title</span>=<span class="string">&quot;轮播图&quot;</span> <span class="attr">banner</span>=<span class="string">&#123;this.state.banner&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">MainBanner</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MainProductList</span> <span class="attr">title</span>=<span class="string">&quot;商品列表&quot;</span> <span class="attr">productList</span>=<span class="string">&#123;this.state.productList&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">MainProductList</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Main</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件 :  <strong>MainBanner.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">MainBanner</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(props) <span class="comment">// 也可以在构造器中获取到父组件传递来的数据 , 相当于 this.props = props</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; title, banner &#125; = <span class="variable language_">this</span>.<span class="property">props</span> <span class="comment">// 3. 子组件从 props 中解构出需要的数据</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 4. 根据数据渲染页面 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;banner.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MainBanner</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件  <strong>MainProductList.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">MainProductList</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; title, productList &#125; = <span class="variable language_">this</span>.<span class="property">props</span> <span class="comment">// 3. 子组件从 props 中解构出需要的数据</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 4. 根据数据渲染页面 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;productList.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="服务器动态数据展示"><a href="#服务器动态数据展示" class="headerlink" title="服务器动态数据展示"></a>服务器动态数据展示</h3><ul>
<li>需要安装 axios : <strong>npm install axios</strong></li>
</ul>
<p>父组件 :  <strong>Main.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MainBanner</span> <span class="keyword">from</span> <span class="string">&#x27;./MainBanner&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MainProductList</span> <span class="keyword">from</span> <span class="string">&#x27;./MainProductList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Main</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="comment">// 1. 数据初始化</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">banners</span>: [],</span><br><span class="line">      <span class="attr">productList</span>: [],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 在组件挂载完毕时,发起网络请求获取数据</span></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    axios.<span class="title function_">get</span>(<span class="string">&#x27;http://123.207.32.32:8000/home/multidata&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> banners = res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">banner</span>.<span class="property">list</span></span><br><span class="line">      <span class="keyword">const</span> recommend = res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">recommend</span>.<span class="property">list</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        banners,</span><br><span class="line">        <span class="attr">productList</span>: recommend,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Main<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 2. 将数据传递给子组件 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MainBanner</span> <span class="attr">title</span>=<span class="string">&quot;轮播图&quot;</span> <span class="attr">banners</span>=<span class="string">&#123;this.state.banners&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">MainBanner</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MainProductList</span> <span class="attr">title</span>=<span class="string">&quot;商品列表&quot;</span> <span class="attr">productList</span>=<span class="string">&#123;this.state.productList&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">MainProductList</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Main</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件 :  <strong>MainBanner.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">MainBanner</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; title, banners &#125; = <span class="variable language_">this</span>.<span class="property">props</span> <span class="comment">// 3. 子组件从 props 中解构出需要的数据</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 4. 根据数据渲染页面 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;banners.map((item) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.acm&#125;</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MainBanner</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件  <strong>MainProductList.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">MainProductList</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; title, productList &#125; = <span class="variable language_">this</span>.<span class="property">props</span> <span class="comment">// 3. 子组件从 props 中解构出需要的数据</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 4. 根据数据渲染页面 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;productList.map((item) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.acm&#125;</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="参数校验与默认值"><a href="#参数校验与默认值" class="headerlink" title="参数校验与默认值"></a>参数校验与默认值</h3><ul>
<li>对于传递给子组件的数据，有时候我们可能希望进行验证，特别是对于大型项目来说：<ul>
<li>当然，如果你项目中默认继承了 Flow 或者 TypeScript，那么直接就可以进行类型验证；</li>
<li>但是，即使我们没有使用 Flow 或者 TypeScript，也可以通过 prop-types 库来进行参数验证；</li>
</ul>
</li>
<li>从 React v15.5 开始，React.PropTypes 已移入另一个包中：prop-types 库</li>
<li>更多的验证方式，可以参考官网：<a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/docs/typechecking-with-proptypes.html">https://zh-hans.reactjs.org/docs/typechecking-with-proptypes.html</a><ul>
<li>比如验证数组，并且数组中包含哪些元素；</li>
<li>比如验证对象，并且对象中包含哪些 key 以及 value 是什么类型；</li>
<li>比如某个原生是必须的，使用 requiredFunc: PropTypes.func.isRequired</li>
</ul>
</li>
<li>如果没有传递，我们希望有默认值呢？<ul>
<li>我们使用 defaultProps 就可以了</li>
</ul>
</li>
</ul>
<p>父组件 :  <strong>Main.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">MainBanner</span> banners=&#123;banners&#125; title=&#123;<span class="string">&#x27;轮播图&#x27;</span>&#125;&gt;&lt;/<span class="title class_">MainBanner</span>&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">MainBanner</span> <span class="attr">banners</span>=<span class="string">&#123;banners&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">MainBanner</span>&gt;</span></span> &#123;<span class="comment">/* 未传递 title 给子组件,将会使用子组件的默认值*/</span>&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件 :  <strong>MainBanner.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span> <span class="comment">// 0. 导入依赖,提供数据校验,脚手架已内置</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">MainBanner</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; title, banners &#125; = <span class="variable language_">this</span>.<span class="property">props</span> <span class="comment">// 3. 子组件从 props 中解构出需要的数据</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 4. 根据数据渲染页面 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;banners.map((item) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.acm&#125;</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 数据类型校验</span></span><br><span class="line"><span class="title class_">MainBanner</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">banners</span>: <span class="title class_">PropTypes</span>.<span class="property">array</span>.<span class="property">isRequired</span>, <span class="comment">// 要求传递一个数组,必须项</span></span><br><span class="line">  <span class="attr">title</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>, <span class="comment">// 要求传递一个字符串</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 默认值,父组件没有传递数据过来时,就会使用默认值</span></span><br><span class="line"><span class="title class_">MainBanner</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">banners</span>: [],</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;默认标题&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MainBanner</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>默认值的另一种扩展写法 :</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">MainBanner</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// 在 ES 高级中,也可以将默认值写到类中,作为类的静态属性,这是 ES 13 的新特性,目前还比较少使用该写法</span></span><br><span class="line">  <span class="comment">// 即, 为该组件提供默认值</span></span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    <span class="attr">banners</span>: [],</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;我是默认标题&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="子组件传递父组件"><a href="#子组件传递父组件" class="headerlink" title="子组件传递父组件"></a>子组件传递父组件</h3><ul>
<li><p>某些情况，我们也需要子组件向父组件传递消息：</p>
<ul>
<li>在 vue 中是通过自定义事件来完成的；</li>
<li>在 React 中同样是通过 props 传递消息，只是让父组件给子组件传递一个回调函数，在子组件中调用这个函数即可；</li>
</ul>
</li>
<li><p>我们这里来完成一个案例：</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/9dd2197867a341a5a496897724f4a642" alt="1666498585648"></p>
<ul>
<li>将计数器案例进行拆解；</li>
<li>将按钮封装到子组件中：AddCounter；</li>
<li>AddCounter 发生点击事件，将内容传递到父组件中，修改 counter 的值；</li>
</ul>
</li>
</ul>
<p>父组件 : <strong>app.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AddCounter</span> <span class="keyword">from</span> <span class="string">&#x27;./components/AddCounter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="number">100</span>, <span class="comment">// 1. 数据初始化</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 2. 定义一个方法,用于接收子组件传来的数据,形参就是接收到的数据</span></span><br><span class="line">  changeCounter = <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">counter</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">counter</span> + count,<span class="comment">// 6. 修改父组件中的数据</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; counter &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>当前计数:&#123;counter&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; /* 3. 传递一个函数给子组件,在函数中调用定义的方法,接收数据 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">AddCounter</span> <span class="attr">addClick</span>=<span class="string">&#123;(count)</span> =&gt;</span> &#123; this.changeCounter(count)&#125;&#125;&gt;<span class="tag">&lt;/<span class="name">AddCounter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件: <strong>.&#x2F;Components&#x2F;AddCounter.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AddCounter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// 5. 在事件回调中调用父组件传递来的方法,并传递参数</span></span><br><span class="line">  addCount = <span class="function">(<span class="params">count</span>) =&gt;</span> &#123; </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">addClick</span>(count)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; /* 4. 给按钮添加点击事件并传递参数 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;this.addCount(1)&#125;&#125;&gt;+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;this.addCount(5)&#125;&#125;&gt;+5<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;this.addCount(10)&#125;&#125;&gt;+10<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AddCounter</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>图解:</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/b3a188a437e04a239f0d28cbfe837f16" alt="1671432799322"></p>
<h3 id="组件间通信案例"><a href="#组件间通信案例" class="headerlink" title="组件间通信案例"></a>组件间通信案例</h3><p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/85c8764fd01b4e34adbd5aaa751cd639" alt="1666501397200"></p>
<p>父组件 : <strong>app.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TabControl</span> <span class="keyword">from</span> <span class="string">&#x27;./components/TabControl&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">titles</span>: [<span class="string">&#x27;流行&#x27;</span>, <span class="string">&#x27;新款&#x27;</span>, <span class="string">&#x27;精选&#x27;</span>], <span class="comment">// 1. 数据初始化</span></span><br><span class="line">      <span class="attr">tabIndex</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 2. 定义一个方法,传递给子组件,并接收来自子组件的数据</span></span><br><span class="line">  tabClick = <span class="function">(<span class="params">index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">tabIndex</span>: index, <span class="comment">// 8. 接收到子组件的传参,并修改状态</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; titles, tabIndex &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/** 3. 渲染页面,并将数据和方法传递给子组件 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TabControl</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">titles</span>=<span class="string">&#123;titles&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">tabClick</span>=<span class="string">&#123;(index)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.tabClick(index)</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">TabControl</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;titles[tabIndex]&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件 : <strong>.&#x2F;Components&#x2F;TabControl.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">TabControl</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">currentIndex</span>: <span class="number">0</span>, <span class="comment">// 4. 数据初始化</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 7. 在事件回调中,修改状态值,并调用父组件传递来的方法,并传参</span></span><br><span class="line">  itemClick = <span class="function">(<span class="params">index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">currentIndex</span>: index &#125;)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">tabClick</span>(index)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; titles &#125; = <span class="variable language_">this</span>.<span class="property">props</span> <span class="comment">// 5. 接收来自父组件的数据</span></span><br><span class="line">    <span class="keyword">const</span> &#123; currentIndex &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="comment">// 6. 根据数据渲染页面,并添加点击事件并传递参数,动态绑定类名</span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;tab-control&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;titles.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;this.itemClick(index)&#125;&#125;</span></span><br><span class="line"><span class="language-xml">              className=&#123;`item $&#123;index === currentIndex ? &#x27;active&#x27; : &#x27;&#x27;&#125;`&#125;</span></span><br><span class="line"><span class="language-xml">            &gt;</span></span><br><span class="line"><span class="language-xml">              &#123;item&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">TabControl</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对应的 CSS 样式:  <strong>.&#x2F;TabControl.css</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.tab-control</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tab-control</span> <span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tab-control</span> <span class="selector-class">.item</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tab-control</span> <span class="selector-class">.item</span><span class="selector-class">.active</span> <span class="selector-class">.text</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">3px</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">3px</span> solid red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>图解 :</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/d772d238e5e047f587a7835a8128a89d" alt="1667714276858"></p>
<h3 id="插槽的实现"><a href="#插槽的实现" class="headerlink" title="插槽的实现"></a>插槽的实现</h3><h4 id="插槽的作用"><a href="#插槽的作用" class="headerlink" title="插槽的作用"></a>插槽的作用</h4><ul>
<li>在开发中，我们抽取了一个组件，但是为了让这个组件具备更强的通用性，我们不能将组件中的内容限制为固定的 div、span 等等这些元素。</li>
<li>我们应该让使用者可以决定某一块区域到底存放什么内容。</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/b022274cd4c54f1fa7e0a977aeeb04bd" alt="image-20230312112213109"></p>
<ul>
<li>这种需求在 Vue 当中有一个固定的做法是通过 slot 来完成的，React 呢？</li>
<li>React 对于这种需要插槽的情况非常灵活，有两种方案可以实现：<ul>
<li>组件的 children 子元素；</li>
<li>props 属性传递 React 元素；</li>
</ul>
</li>
</ul>
<h4 id="children实现插槽"><a href="#children实现插槽" class="headerlink" title="children实现插槽"></a>children实现插槽</h4><p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/ff6415e626c2488d934d647deceeaa3c" alt="1666502946860"></p>
<ul>
<li>每个组件都可以获取到 props.children：它包含组件的开始标签和结束标签之间的内容。</li>
</ul>
<p>父组件 : <strong>app.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NavBar</span> <span class="keyword">from</span> <span class="string">&#x27;./Components/NavBar/NavBar.jsx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">NavBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/* 在子组件使用时,传递多个 DOM 结构,则在子组件中解构出来的 children 是一个数组,元素为传递的 DOM 结构 */&#125;</span></span><br><span class="line"><span class="language-xml">          &#123;/* 如果只传递了一个 DOM 结构,则在子组件中解构出来的 children 就是传递的 DOM 结构,不再是一个数组*/&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h2</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">i</span>&gt;</span>分享<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">NavBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件 : <strong>.&#x2F;Components&#x2F;NavBar&#x2F;NavBar.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./NavBar.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">NavBar</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 从 props 中解构出 children , 类型为一个数组</span></span><br><span class="line">    <span class="keyword">const</span> &#123; children &#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">    <span class="comment">// 渲染页面</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;nav-bar&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;left&quot;</span>&gt;</span>&#123;children[0]&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;center&quot;</span>&gt;</span>&#123;children[1]&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;right&quot;</span>&gt;</span>&#123;children[2]&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">NavBar</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对应的 CSS 样式:  <strong>.&#x2F;NavBar.css</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav-bar</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span>,</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f80</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="props实现插槽"><a href="#props实现插槽" class="headerlink" title="props实现插槽"></a>props实现插槽</h4><ul>
<li>通过 children 实现的方案虽然可行，但是有一个弊端：通过索引值获取传入的元素很容易出错，不能精准的获取传入的原生；</li>
<li>另外一个种方案就是使用 props 实现,该方法使用较多：<ul>
<li>通过具体的属性名，可以让我们在传入和获取时更加的精准；</li>
</ul>
</li>
</ul>
<p>父组件:  <strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NavBar</span> <span class="keyword">from</span> <span class="string">&#x27;./Components/NavBar/NavBar.jsx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">btn</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; btn &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/** 将 DOM 结构作为数据传递给子组件 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">NavBar</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">leftSlot</span>=<span class="string">&#123;btn&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">centerSlot</span>=<span class="string">&#123;</span>&lt;<span class="attr">h2</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">          rightSlot=&#123;<span class="tag">&lt;<span class="name">i</span>&gt;</span>斜体<span class="tag">&lt;/<span class="name">i</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">NavBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件 : <strong>.&#x2F;Components&#x2F;NavBar&#x2F;NavBar.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./NavBar.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">NavBar</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 从 props 中解构出需要的数据</span></span><br><span class="line">    <span class="keyword">const</span> &#123; leftSlot, centerSlot, rightSlot &#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">    <span class="comment">// 渲染页面</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;nav-bar&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;left&quot;</span>&gt;</span>&#123;leftSlot&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;center&quot;</span>&gt;</span>&#123;centerSlot&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;right&quot;</span>&gt;</span>&#123;rightSlot&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">NavBar</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="作用域插槽的实现"><a href="#作用域插槽的实现" class="headerlink" title="作用域插槽的实现"></a>作用域插槽的实现</h4><p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/f546c83f8e274bc3a036f02d8aadf8c5" alt="1671003519262"></p>
<p>父组件 : <strong>.&#x2F;App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TabControl</span> <span class="keyword">from</span> <span class="string">&#x27;./TabControl&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">titles</span>: [<span class="string">&#x27;流行&#x27;</span>, <span class="string">&#x27;新款&#x27;</span>, <span class="string">&#x27;精选&#x27;</span>],</span><br><span class="line">      <span class="attr">tabIndex</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过方法接收到子组件传递来的数据</span></span><br><span class="line">  <span class="title function_">tabClick</span>(<span class="params">tabIndex</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; tabIndex &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过方法接收到子组件传递来的数据,并控制渲染结构</span></span><br><span class="line">  <span class="title function_">getTabItem</span>(<span class="params">item</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (item === <span class="string">&#x27;流行&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item === <span class="string">&#x27;新款&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">i</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; titles, tabIndex &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TabControl</span> <span class="attr">titles</span>=<span class="string">&#123;titles&#125;</span> <span class="attr">tabClick</span>=<span class="string">&#123;(i)</span> =&gt;</span> this.tabClick(i)&#125; itemType=&#123;(item) =&gt; this.getTabItem(item)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;titles[tabIndex]&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>子组件 <strong>.&#x2F;TabControlindex.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">TabControl</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">currentIndex</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">itemClick</span>(<span class="params">index</span>) &#123;</span><br><span class="line">    <span class="comment">// 1.自己保存最新的index</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">currentIndex</span>: index &#125;)</span><br><span class="line">    <span class="comment">// 2.让父组件执行对应的函数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">tabClick</span>(index)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; titles, itemType &#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">    <span class="keyword">const</span> &#123; currentIndex &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;tab-control&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;titles.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">item</span> $&#123;<span class="attr">index</span> === <span class="string">currentIndex</span> ? &#x27;<span class="attr">active</span>&#x27; <span class="attr">:</span> &#x27;&#x27;&#125;`&#125; <span class="attr">key</span>=<span class="string">&#123;item&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.itemClick(index)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              &#123;itemType(item)&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">TabControl</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h3><h4 id="Context-基本使用"><a href="#Context-基本使用" class="headerlink" title="Context 基本使用"></a>Context 基本使用</h4><ul>
<li>非父子组件数据的共享：<ul>
<li>在开发中，比较常见的数据传递方式是通过 props 属性自上而下（由父到子）进行传递。</li>
<li>但是对于有一些场景：比如一些数据需要在多个组件中进行共享（地区偏好、UI 主题、用户登录状态、用户信息等）。</li>
<li>如果我们在顶层的 App 中定义这些信息，之后一层层传递下去，那么对于一些中间层不需要数据的组件来说，是一种冗余的操作。</li>
</ul>
</li>
<li>我们实现一个一层层传递的案例：<ul>
<li>我这边顺便补充一个小的知识点：Spread Attributes</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Home</span> &#123;...info&#125;&gt;&lt;<span class="regexp">/Home&gt; &#123;/</span>* info 是一个对象 */&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>但是，如果层级更多的话，一层层传递是非常麻烦，并且代码是非常冗余的：<ul>
<li>React 提供了一个 API：<strong>Context</strong></li>
<li>Context 提供了一种在组件之间共享此类值的方式，而不必显式地通过组件树的逐层传递 props；</li>
<li>Context 设计目的是为了共享那些对于一个组件树而言是“全局”的数据，例如当前认证的用户、主题或首选语言；</li>
</ul>
</li>
</ul>
<p><strong>.&#x2F;context&#x2F;theme-context.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 01. 创建 context</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ThemeContext</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>提供数据的父组件 : <strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./Components/Home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;./context/theme-context&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 02. 通过 ThemeContext.Provider 的 value 属性给后代组件提供数据 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> &#x27;<span class="attr">red</span>&#x27;, <span class="attr">size:</span> &#x27;<span class="attr">30</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Home</span>&gt;</span><span class="tag">&lt;/<span class="name">Home</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要数据的后代组件: <strong>HomeInfo.jsx</strong> , 该组件是上面使用的 home 组件的后代组件</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;../context/theme-context&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">HomeInfo</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 04. 通过 this.context 获取到数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">context</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>HomeInfo :&#123;this.context.color&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 03. 在需要数据的地方,设置组件的 contextType 为某一个 context</span></span><br><span class="line"><span class="title class_">HomeInfo</span>.<span class="property">contextType</span> = <span class="title class_">ThemeContext</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HomeInfo</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>在函数式子组件中获取到共享的数据 :</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;../context/theme-context&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数式组件中使用 Context 共享的数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">HomeBanner</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>HomeBanner<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ThemeContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;(value) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;value.color&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ThemeContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HomeBanner</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Context相关API"><a href="#Context相关API" class="headerlink" title="Context相关API"></a>Context相关API</h4><ul>
<li><p>React.createContext</p>
<ul>
<li>创建一个需要共享的 Context 对象：</li>
<li>如果一个组件订阅了 Context，那么这个组件会从离自身最近的那个匹配的 Provider 中读取到当前的 context 值；</li>
<li>defaultValue 是组件在顶层查找过程中没有找到对应的 Provider，那么就使用默认值</li>
</ul>
</li>
<li><p>Context.Provider</p>
<ul>
<li>每个 Context 对象都会返回一个 Provider React 组件，它允许消费组件订阅 context 的变化：</li>
<li>Provider 接收一个 value 属性，传递给消费组件；</li>
<li>一个 Provider 可以和多个消费组件有对应关系；</li>
<li>多个 Provider 也可以嵌套使用，里层的会覆盖外层的数据；</li>
<li>当 Provider 的 value 值发生变化时，它内部的所有消费组件都会重新渲染；</li>
</ul>
</li>
<li><p>Class.contextType</p>
<ul>
<li>挂载在 class 上的 contextType 属性会被重赋值为一个由 React.createContext() 创建的 Context 对象：</li>
<li>这能让你使用 this.context 来消费最近 Context 上的那个值；</li>
<li>你可以在任何生命周期中访问到它，包括 render 函数中；</li>
</ul>
</li>
<li><p>Context.Consumer</p>
<ul>
<li>这里，React 组件也可以订阅到 context 变更。这能让你在 函数式组件 中完成订阅 context。</li>
<li>这里需要 函数作为子元素（function as child）这种做法；</li>
<li>这个函数接收当前的 context 值，返回一个 React 节点；</li>
</ul>
</li>
</ul>
<h4 id="Context的默认值"><a href="#Context的默认值" class="headerlink" title="Context的默认值"></a>Context的默认值</h4><ul>
<li>什么时候使用默认值 defaultValue 呢？</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 01. 创建 context,并提供一个默认值</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>(&#123; <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>, <span class="attr">size</span>: <span class="string">&quot;10&quot;</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ThemeContext</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./Components/Home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;./context/theme-context&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 02. 通过 ThemeContext.Provider 的 value 属性给后代组件提供数据 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> &#x27;<span class="attr">red</span>&#x27;, <span class="attr">size:</span> &#x27;<span class="attr">30</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Home</span>&gt;</span><span class="tag">&lt;/<span class="name">Home</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Home</span>&gt;</span><span class="tag">&lt;/<span class="name">Home</span>&gt;</span>&#123;/** 该组件没有在 ThemeContext.Provider 组件中,将使用默认值  */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;../context/theme-context&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">HomeInfo</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 04. 通过 this.context 获取到数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;111&#x27;</span>, <span class="variable language_">this</span>.<span class="property">context</span>) <span class="comment">// &#123;color: &#x27;blue&#x27;, size: &quot;10&quot;&#125; , 获取到的是默认值</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>HomeInfo :&#123;this.context.color&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 03. 在需要数据的地方,设置组件的 contextType 为某一个 context</span></span><br><span class="line"><span class="title class_">HomeInfo</span>.<span class="property">contextType</span> = <span class="title class_">ThemeContext</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HomeInfo</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>什么时候使用 Context.Consumer 呢？<ul>
<li>当使用 value 的组件是一个函数式组件时；</li>
<li>当组件中需要使用多个 Context 时；</li>
</ul>
</li>
</ul>
<h3 id="全局事件总线"><a href="#全局事件总线" class="headerlink" title="全局事件总线"></a>全局事件总线</h3><ul>
<li>安装依赖 : <strong>npm install hy-event-store</strong></li>
</ul>
<p>创建实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">HYEventBus</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;hy-event-store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventBus = <span class="keyword">new</span> <span class="title class_">HYEventBus</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> eventBus</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>任意组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> eventBus <span class="keyword">from</span> <span class="string">&#x27;../utils/event-bus&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">HomeInfo</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  btnClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    eventBus.<span class="title function_">emit</span>(<span class="string">&#x27;bannerPrev&#x27;</span>, <span class="string">&#x27;why&#x27;</span>, <span class="number">18</span>, <span class="number">1.88</span>) <span class="comment">// 发射一个自定义事件,并携带参数</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>HomeInfo<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; this.btnClick() &#125;&#125;&gt; 按钮 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HomeInfo</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>任意组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./Components/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> eventBus <span class="keyword">from</span> <span class="string">&#x27;./utils/event-bus&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// 组件挂载</span></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    eventBus.<span class="title function_">on</span>(<span class="string">&#x27;bannerPrev&#x27;</span>, <span class="variable language_">this</span>.<span class="property">bannerPrevClick</span>) <span class="comment">// 监听事件  事件回调</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  bannerPrevClick = <span class="function">(<span class="params">name, age, height</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;app中监听到 bannerPrev &#x27;</span>, name, age, height) <span class="comment">// 获取到传递来的数据</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 组件卸载</span></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    eventBus.<span class="title function_">off</span>(<span class="string">&#x27;bannerPrev&#x27;</span>, <span class="variable language_">this</span>.<span class="property">bannerPrevClick</span>) <span class="comment">// 移除监听 要移除的事件回调</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Home</span>&gt;</span><span class="tag">&lt;/<span class="name">Home</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="setState-难点"><a href="#setState-难点" class="headerlink" title="setState(难点)"></a>setState(难点)</h2><h3 id="为什么使用setState"><a href="#为什么使用setState" class="headerlink" title="为什么使用setState"></a>为什么使用setState</h3><ul>
<li>开发中我们并不能直接通过修改 state 的值来让界面发生更新：<ul>
<li>因为我们修改了 state 之后，希望 React 根据最新的 State 来重新渲染界面，但是这种方式的修改 React 并不知道数据发生了变化；</li>
<li><strong>React 并没有实现类似于 Vue2 中的 Object.defineProperty 或者 Vue3 中的 Proxy 的方式来监听数据的变化；</strong></li>
<li>我们<strong>必须通过 setState 来告知 React 数据已经发生了变化</strong>；</li>
</ul>
</li>
<li>疑惑：在组件中并没有实现 setState 的方法，为什么可以调用呢？<ul>
<li>原因很简单，<strong>setState 方法是从 Component 中继承过来的</strong>。</li>
</ul>
</li>
<li>对应的源码 :</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/images/1666529986004.png" alt="1666529986004"></p>
<h3 id="setState异步更新"><a href="#setState异步更新" class="headerlink" title="setState异步更新"></a>setState异步更新</h3><ul>
<li>setState 的更新是异步的？<ul>
<li>最终打印结果是 Hello World；</li>
<li>可见 setState 是异步的操作，我们并不能在执行完 setState 之后立马拿到最新的 state 的结果</li>
</ul>
</li>
<li>为什么 setState 设计为异步呢？<ul>
<li>setState 设计为异步其实之前在 GitHub 上也有很多的讨论；</li>
<li>React 核心成员（ Redux 的作者）Dan Abramov 也有对应的回复，有兴趣的同学可以参考一下；</li>
<li><a target="_blank" rel="noopener" href="https://github.com/facebook/react/issues/11527#issuecomment-360199710%EF%BC%9B">https://github.com/facebook/react/issues/11527#issuecomment-360199710；</a></li>
</ul>
</li>
<li>我对其回答做一个简单的总结：</li>
<li><strong>setState 设计为异步，可以显著的提升性能</strong>；<ul>
<li>如果<strong>每次调用 setState 都进行一次更新，那么意味着 render 函数会被频繁调用，界面重新渲染，这样效率是很低的</strong>；</li>
<li>最好的办法应该是<strong>获取到多个更新，之后进行批量更新</strong>；<ul>
<li>即在一个回调中,多次调用 setState 方法,会将每个 setState 加入到任务队列中,再统一进行批量更新,数据只会更新一次<ul>
<li>如果 setState 是同步的,则在一个回调中多次调用,则会多次执行 render 方法进行多次渲染,但实际并不是这样</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>如果同步更新了 state，但是还没有执行 render 函数，那么 state 和 props 不能保持同步；</strong><ul>
<li>state 和 props 不能保持一致性，会在开发中产生很多的问题；</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好师姐&#x27;</span>,</span><br><span class="line">      <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  btnClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 1. 给 setState 传递一个对象,会将属性与 state 中的合并,同名覆盖 ,底层是调用 Object.assign(this.state,newState)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好,世界&#x27;</span>,</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">message</span>)&#125;) <span class="comment">// 你好,世界 ,  获取到的是新值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 给 setState 传递一个回调函数,新的 state 由函数的返回值决定,同样是合并到旧 state 中,同名覆盖,调用 Object.assign</span></span><br><span class="line">    <span class="comment">//    2.1 可以在回调中对新的 state 编写对应的业务逻辑</span></span><br><span class="line">    <span class="comment">//    2.2 当前的回调可以访问到之前旧的 state 和 props</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">message</span>) <span class="comment">// 你好师姐</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. setState 是异步调用的,执行该行时,state 还没有更新数据</span></span><br><span class="line">    <span class="comment">//    如果希望在 state 数据更新之后获取到新的数据,则可以给 setState 传递第二个参数,该参数为一个函数,state 更新完后会自己调用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">message</span>) <span class="comment">// 你好师姐 , 获取到的是旧值</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;this.btnClick()&#125;&#125;&gt;按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="获取异步的结果"><a href="#获取异步的结果" class="headerlink" title="获取异步的结果"></a>获取异步的结果</h3><ul>
<li>那么如何可以获取到更新后的值呢？</li>
<li>setState 的回调<ul>
<li>setState 接受两个参数：第二个参数是一个回调函数，这个回调函数会在更新后会执行；</li>
<li>格式如下：setState (partialState, callback)</li>
<li>代码见上一小节</li>
</ul>
</li>
</ul>
<h3 id="setState的异步"><a href="#setState的异步" class="headerlink" title="setState的异步"></a>setState的异步</h3><ul>
<li><p>React18 之前 , 其实分成两种情况：</p>
<ul>
<li>在组件生命周期或 React 合成事件中，setState 是异步；</li>
<li>在 setTimeout 或者原生 dom 事件中，setState 是同步；</li>
<li>在 react 18 之前 , promise , setTimeout, 原生事件绑定中, setSate 是同步的<ul>
<li>但是到了 react 18 后,这些都是异步的,都会进行批处理</li>
</ul>
</li>
</ul>
</li>
<li><p>验证一：在 setTimeout 中的更新：</p>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">btnClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 在react18之前, setTimeout 中 setState 操作,是同步操作</span></span><br><span class="line">  <span class="comment">// 在react18之后，setTimeout 中 setState 异步操作(批处理)</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;你好,李银河&#x27;</span> &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">message</span>) <span class="comment">// 你好师姐</span></span><br><span class="line">  &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>验证二：原生 DOM 事件：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>React18 之后,默认所有的操作都被放到了批处理中（异步处理）。如果希望代码可以同步会拿到，则需要执行特殊的 flushSync 操作：</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; flushSync &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line">btnClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">flushSync</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;你好,李银河&#x27;</span> &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">message</span>) <span class="comment">// 你好,李银河  ,此时 setState 是同步的</span></span><br><span class="line">  &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="React的更新机制-难点"><a href="#React的更新机制-难点" class="headerlink" title="React的更新机制(难点)"></a>React的更新机制(难点)</h2><h3 id="React更新流程"><a href="#React更新流程" class="headerlink" title="React更新流程"></a>React更新流程</h3><ul>
<li>我们在前面已经学习 React 的渲染流程：</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/b1bbaa6d698842fe833848d0935062e7" alt="1666522719562"></p>
<ul>
<li>那么 React 的更新流程呢？</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/4d0d6053ce05445fbc019f7f30f8c70d" alt="1666522755713"></p>
<ul>
<li><p>React 在 props 或 state 发生改变时，会调用 React 的 render 方法，会创建一颗不同的树。</p>
</li>
<li><p>React 需要基于这两颗不同的树之间的差别来判断如何有效的更新 UI：</p>
<ul>
<li>如果一棵树参考另外一棵树进行完全比较更新，那么即使是最先进的算法，该算法的复杂程度为 O(n³)，其中 n 是树中元素的数量；</li>
<li><a target="_blank" rel="noopener" href="https://grfia.dlsi.ua.es/ml/algorithms/references/editsurvey_bille.pdf%EF%BC%9B">https://grfia.dlsi.ua.es/ml/algorithms/references/editsurvey_bille.pdf；</a></li>
<li>如果在 React 中使用了该算法，那么展示 1000 个元素所需要执行的计算量将在十亿的量级范围；</li>
<li>这个开销太过昂贵了，React 的更新性能会变得非常低效；</li>
</ul>
</li>
<li><p>于是，React 对这个算法进行了优化，将其优化成了 O(n)，如何优化的呢？</p>
<ul>
<li><strong>同层节点之间相互比较，不会跨节点比较；</strong></li>
<li><strong>不同类型的节点，产生不同的树结构；</strong></li>
<li><strong>开发中，可以通过 key 来指定哪些节点在不同的渲染下保持稳定；</strong></li>
</ul>
</li>
</ul>
<h3 id="keys的优化"><a href="#keys的优化" class="headerlink" title="keys的优化"></a>keys的优化</h3><ul>
<li><p>我们在前面遍历列表时，总是会提示一个警告，让我们加入一个 key 属性</p>
</li>
<li><p>方式一：在最后位置插入数据</p>
<ul>
<li>这种情况，有无 key 意义并不大</li>
</ul>
</li>
<li><p>方式二：在前面插入数据</p>
<ul>
<li>这种做法，在没有 key 的情况下，所有的 li 都需要进行修改；</li>
</ul>
</li>
<li><p>当子元素(这里的 li )拥有 key 时，React 使用 key 来匹配原有树上的子元素以及最新树上的子元素：</p>
<ul>
<li>在下面这种场景下，key 为 111 和 222 的元素仅仅进行位移，不需要进行任何的修改；</li>
<li>将 key 为 333 的元素插入到最前面的位置即可；</li>
</ul>
</li>
<li><p>key 的注意事项：</p>
<ul>
<li><strong>key 应该是唯一的；</strong></li>
<li><strong>key 不要使用随机数（随机数在下一次 render 时，会重新生成一个数字）；</strong></li>
<li><strong>使用 index 作为 key，对性能是没有优化的；</strong></li>
</ul>
</li>
</ul>
<h3 id="render函数的优化"><a href="#render函数的优化" class="headerlink" title="render函数的优化"></a>render函数的优化</h3><ul>
<li>我们使用之前的一个嵌套案例：<ul>
<li>在 App 中，我们增加了一个计数器的代码；</li>
<li>当点击 +1 时，会重新调用 App 的 render 函数；</li>
<li>而当 App 的 render 函数被调用时，所有的子组件的 render 函数都会被重新调用；</li>
</ul>
</li>
<li>那么，我们可以思考一下，在以后的开发中，我们只要是修改了 App 中的数据，所有的组件都需要重新 render，进行 diff 算法，性能必然是很低的：<ul>
<li>事实上，很多的组件没有必须要重新 render；</li>
<li>它们调用 render 应该有一个前提，就是依赖的数据（state、 props）发生改变时，再调用自己的 render 方法；</li>
</ul>
</li>
<li>如何来控制 render 方法是否被调用呢？<ul>
<li>通过 shouldComponentUpdate 方法即可；</li>
</ul>
</li>
</ul>
<p><strong>任意类组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生命周期函数</span></span><br><span class="line"><span class="title function_">shouldComponentUpdate</span>(<span class="params">newProps, newSate</span>) &#123;</span><br><span class="line">  <span class="comment">// 通过新旧的 state 值, props 值进行对比,决定 render 方法是否需要重新执行,性能优化</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">message</span> !== newSate.<span class="property">message</span> || <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">message</span> !== newProps.<span class="property">message</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// 重新渲染</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// 不重新渲染</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>以下是对该生命周期函数的详解</li>
</ul>
<h3 id="SCU生命周期方法"><a href="#SCU生命周期方法" class="headerlink" title="SCU生命周期方法"></a>SCU生命周期方法</h3><ul>
<li><p>React 给我们提供了一个生命周期方法 shouldComponentUpdate（很多时候，我们简称为 SCU ），这个方法接受参数，并且需要有返回值：</p>
</li>
<li><p>该方法有两个参数：</p>
<ul>
<li>参数一：nextProps 修改之后，最新的 props 属性</li>
<li>参数二：nextState 修改之后，最新的 state 属性</li>
</ul>
</li>
<li><p>该方法返回值是一个 boolean 类型：</p>
<ul>
<li>返回值为 true，那么就需要调用 render 方法；</li>
<li>返回值为 false，那么久不需要调用 render 方法；</li>
<li>默认返回的是 true，也就是只要 state 发生改变，就会调用 render 方法；</li>
</ul>
</li>
<li><p>比如我们在 App 中增加一个 message 属性：</p>
<ul>
<li>jsx 中并没有依赖这个 message，那么它的改变不应该引起重新渲染；</li>
<li>但是因为 render 监听到 state 的改变，就会重新 render，所以最后 render 方法还是被重新调用了；</li>
</ul>
</li>
</ul>
<h3 id="PureComponent"><a href="#PureComponent" class="headerlink" title="PureComponent"></a>PureComponent</h3><ul>
<li>如果所有的类，我们都需要手动来实现 shouldComponentUpdate，那么会给我们开发者增加非常多的工作量。<ul>
<li>我们来设想一下 shouldComponentUpdate 中的各种判断的目的是什么？</li>
<li>props 或者 state 中的数据是否发生了改变，来决定 shouldComponentUpdate 返回 true 或者 false；</li>
</ul>
</li>
<li>事实上 React 已经考虑到了这一点，所以 React 已经默认帮我们实现好了，如何实现呢？<ul>
<li>将 class 继承自 PureComponent。</li>
</ul>
</li>
</ul>
<p><strong>任意类组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 类组件在创建组件时,继承 PureComponent , 则内部会自动判断 state 和 props 有没有改变</span></span><br><span class="line"><span class="comment">//	如果没有改变,就不会重新渲染该组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;你好师姐&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="shallowEqual方法"><a href="#shallowEqual方法" class="headerlink" title="shallowEqual方法"></a>shallowEqual方法</h3><ul>
<li>这个方法中，调用 <code>!shallowEqual(oldProps, newProps) || !shallowEqual(oldState, newState)</code>，这个 shallowEqual 就是进行浅层比较：</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/6aae0084e6a6445f83e3462fa5f15f13" alt="1666590254588"></p>
<h3 id="高阶组件memo"><a href="#高阶组件memo" class="headerlink" title="高阶组件memo"></a>高阶组件memo</h3><ul>
<li>目前我们是针对类组件可以使用 PureComponent，那么函数式组件呢？<ul>
<li>事实上函数式组件我们在 props 没有改变时，也是不希望其重新渲染其 DOM 树结构的</li>
</ul>
</li>
<li>我们需要使用一个高阶组件 memo：<ul>
<li>我们将之前的 Header、Banner、ProductList 都通过 memo 函数进行一层包裹；</li>
<li>Footer 没有使用 memo 函数进行包裹；</li>
<li>最终的效果是，当 counter 发生改变时，Header、Banner、ProductList 的函数不会重新执行；</li>
<li>而 Footer 的函数会被重新执行；</li>
</ul>
</li>
</ul>
<p><strong>任意函数组件</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; memo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 某一个子组件,函数式组件</span></span><br><span class="line"><span class="comment">// 该子组件所依赖的 message 数据来自 props</span></span><br><span class="line"><span class="comment">// 如果父组件中 message 没有被改变,则该函数式组件不会被重新渲染</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Profile</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> (<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;profile render&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Profile:&#123;props.message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Profile</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="数据的不可变"><a href="#数据的不可变" class="headerlink" title="数据的不可变"></a>数据的不可变</h3><ul>
<li>对于 state 中,数组或对象这些引用类型的数据:</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">movies</span>: [<span class="string">&#x27;流浪地球&#x27;</span>, <span class="string">&#x27;红海行动&#x27;</span>, <span class="string">&#x27;战狼2&#x27;</span>],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  btnClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 浅拷贝,产生一个全新的数组/对象</span></span><br><span class="line">    <span class="keyword">const</span> newMovies = [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">movies</span>, <span class="string">&#x27;点爆木星&#x27;</span>] <span class="comment">// 浅拷贝,数组展开</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 对于数组或对象的多层结构的数据改变,也需要先进行浅拷贝,再更新深层次的数据</span></span><br><span class="line">    <span class="comment">// books[index].count++ 仅举例</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新 state </span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">movies</span>: newMovies,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;this.btnClick() &#125;&#125;&gt; 按钮 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="其他高级内容"><a href="#其他高级内容" class="headerlink" title="其他高级内容"></a>其他高级内容</h2><h3 id="如何使用ref"><a href="#如何使用ref" class="headerlink" title="如何使用ref"></a>如何使用ref</h3><ul>
<li>在 React 的开发模式中，通常情况下不需要、也不建议直接操作 DOM 原生，但是某些特殊的情况，确实需要获取到 DOM 进行某些操作：<ul>
<li>管理焦点，文本选择或媒体播放；</li>
<li>触发强制动画；</li>
<li>集成第三方 DOM 库；</li>
<li>我们可以通过 refs 获取 DOM；</li>
</ul>
</li>
<li>如何创建 refs 来获取对应的 DOM 呢？目前有三种方式：</li>
<li>方式一：传入字符串<ul>
<li>使用时通过 this.refs 传入的字符串格式获取对应的元素；</li>
</ul>
</li>
<li>方式二：传入一个对象<ul>
<li>对象是通过 React.createRef() 方式创建出来的；</li>
<li>使用时获取到创建的对象其中有一个 current 属性就是对应的元素；</li>
</ul>
</li>
<li>方式三：传入一个函数<ul>
<li>该函数会在 DOM 被挂载时进行回调，这个函数会传入一个元素对象，我们可以自己保存；</li>
<li>使用时，直接拿到之前保存的元素对象即可；</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span>, createRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">titleRef</span> = <span class="title function_">createRef</span>() <span class="comment">// 1. 创建一个 ref 对象</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">titleEl</span> = <span class="literal">null</span> </span><br><span class="line">  &#125;</span><br><span class="line">  getNativeDOM = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 方式一 : 只需要在 react 元素或组件上绑定一个 ref=&quot;why&quot; 属性 ,能用,但是已经不推荐使用</span></span><br><span class="line">    <span class="comment">// console.log(this.refs.why)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方式二: 提前用 createRef 创建一个 ref 对象,并绑定到元素上,推荐使用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">titleRef</span>.<span class="property">current</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方式三 : 给元素的 ref 属性传递一个函数,该函数的形参就是该 DOM 元素</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">titleEl</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">ref</span>=<span class="string">&quot;why&quot;</span>&gt;</span>App<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/** 2. 将创建的 ref 对象绑定到元素上 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">ref</span>=<span class="string">&#123;this.titleRef&#125;</span>&gt;</span>你好,李银河<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">ref</span>=<span class="string">&#123;(el)</span> =&gt;</span> &#123; this.titleEl = el&#125;&#125;&gt;你好,师姐<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; this.getNativeDOM() &#125;&#125;&gt; 按钮 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ref获取类组件实例"><a href="#ref获取类组件实例" class="headerlink" title="ref获取类组件实例"></a>ref获取类组件实例</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span>, createRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;test~~~~~&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>HelloWorld<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hwRef</span> = <span class="title function_">createRef</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  getComponent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">hwRef</span>.<span class="property">current</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hwRef</span>.<span class="property">current</span>.<span class="title function_">test</span>() <span class="comment">// 调用子组件中的实例方法</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">ref</span>=<span class="string">&#123;this.hwRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">HelloWorld</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; this.getComponent() &#125;&#125;&gt; 获取组件实例<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ref获取函数组件的DOM"><a href="#ref获取函数组件的DOM" class="headerlink" title="ref获取函数组件的DOM"></a>ref获取函数组件的DOM</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span>, createRef, forwardRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数式子组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HelloWorld</span> = <span class="title function_">forwardRef</span>(<span class="keyword">function</span> (<span class="params">props, ref</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span>师姐,你好<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hwRef</span> = <span class="title function_">createRef</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  getComponent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">hwRef</span>.<span class="property">current</span>) <span class="comment">// &lt;h2&gt;师姐,你好&lt;/h2&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">ref</span>=<span class="string">&#123;this.hwRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">HelloWorld</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; this.getComponent()&#125;&#125;&gt; 获取函数组件 DOM <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ref的类型"><a href="#ref的类型" class="headerlink" title="ref的类型"></a>ref的类型</h3><ul>
<li>ref 的值根据节点的类型而有所不同：<ul>
<li>当 ref 属性用于 HTML 元素时，构造函数中使用 React.createRef() 创建的 ref 接收底层 DOM 元素作为其 current 属性；</li>
<li>当 ref 属性用于自定义 class 组件时，ref 对象接收组件的挂载实例作为其 current 属性；</li>
<li>你不能在函数组件上使用 ref 属性，因为他们没有实例；</li>
</ul>
</li>
<li>这里我们演示一下 ref 引用一个 class 组件对象：</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/943e4a10b3a041fbaaee9c89bdfe8d32" alt="1666590499139"></p>
<ul>
<li>函数式组件是没有实例的，所以无法通过 ref 获取他们的实例：<ul>
<li>但是某些时候，我们可能想要获取函数式组件中的某个DOM元素；</li>
<li>这个时候我们可以通过 React.forwardRef ，后面我们也会学习 hooks 中如何使用ref；</li>
<li>示例代码见上一节</li>
</ul>
</li>
</ul>
<h3 id="受控组件"><a href="#受控组件" class="headerlink" title="受控组件"></a>受控组件</h3><ul>
<li>在React中，HTML表单的处理方式和普通的DOM元素不太一样：表单元素通常会保存在一些内部的state。</li>
<li>比如下面的HTML表单元素：<ul>
<li>这个处理方式是DOM默认处理HTML表单的行为，在用户点击提交时会提交到某个服务器中，并且刷新页面；</li>
<li>在React中，并没有禁止这个行为，它依然是有效的；</li>
<li>但是通常情况下会使用JavaScript函数来方便的处理表单提交，同时还可以访问用户填写的表单数据；</li>
<li>实现这种效果的标准方式是使用“受控组件”；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/7e3b401a74df490389ec6941b3d421ba" alt="1666591399902"></p>
<h3 id="常见的受控组件"><a href="#常见的受控组件" class="headerlink" title="常见的受控组件"></a>常见的受控组件</h3><ul>
<li>在 HTML 中，表单元素（如<code>&lt;input&gt;</code>、 <code>&lt;textarea&gt;</code> 和 <code>&lt;select&gt;</code>）之类的表单元素通常自己维护 state，并根据用户输入进行更新。</li>
<li>而在 React 中，可变状态（mutable state）通常保存在组件的 state 属性中，并且只能通过使用 setState()来更新。<ul>
<li>我们将两者结合起来，使 React 的 state 成为“唯一数据源”；</li>
<li>渲染表单的 React 组件还控制着用户输入过程中表单发生的操作；</li>
<li>被 React 以这种方式控制取值的表单输入元素就叫做“受控组件”；</li>
</ul>
</li>
<li>由于在表单元素上设置了 value 属性，因此显示的值将始终为 this.state.value，这使得 React 的 state 成为唯一数据源。</li>
<li>由于 handleUsernameChange 在每次按键时都会执行并更新 React 的 state，因此显示的值将随着用户输入而更新。</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/79e9d8646f9642a095afa308f261811a" alt="1666591479283"></p>
<ul>
<li>textarea 标签<ul>
<li>texteare 标签和 input 比较相似：</li>
</ul>
</li>
<li>select 标签<ul>
<li>select 标签的使用也非常简单，只是它不需要通过 selected 属性来控制哪一个被选中，它可以匹配 state 的 value 来选中。</li>
</ul>
</li>
<li>处理多个输入<ul>
<li>多处理方式可以像单处理方式那样进行操作，但是需要多个监听方法：</li>
<li>这里我们可以使用 ES6 的一个语法：计算属性名（Computed property names）</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">username</span>: <span class="string">&#x27;coderwhy&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  inputChange = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">username</span>: event.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 渲染页面</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; username &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;username&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> &#123;this.inputChange(e)&#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;username&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="文本框"><a href="#文本框" class="headerlink" title="文本框"></a>文本框</h4><ul>
<li>01 将 state 中的变量绑定到输入框的 value 属性</li>
<li>02 绑定 onChange 事件,在回调中修改 state 中的数据</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  <span class="title function_">handleSubmitClick</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="comment">// 1.阻止默认的行为</span></span><br><span class="line">    event.<span class="title function_">preventDefault</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.获取到所有的表单数据, 对数据进行组件</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取所有的输入内容&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">username</span>, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">password</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.以网络请求的方式, 将数据传递给服务器(ajax/fetch/axios)</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// handleUsernameChange(event) &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; username: event.target.value &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// handlePasswordChange(event) &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; password: event.target.value &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  <span class="title function_">handleInputChange</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      [event.<span class="property">target</span>.<span class="property">name</span>]: event.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; username, password &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleSubmitClick(e)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          &#123;/* 用户名和密码 */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&#123;username&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleInputChange(e)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            密码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&#123;password&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleInputChange(e)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="文本域"><a href="#文本域" class="headerlink" title="文本域"></a>文本域</h4><ul>
<li>01 与上面的同理 , 将 state 中的变量绑定到文本域的 value 属性  </li>
<li>02 绑定 onChange 事件,在回调中修改 state 中的数据</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 01 导入react和react-dom</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 02 创建组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">desc</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  handleDesc = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">desc</span>: e.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        描述：<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">value</span>=<span class="string">&#123;this.state.desc&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleDesc&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 03 渲染react元素</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)) <span class="comment">// 指定渲染到那个容器</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span>&gt;</span><span class="tag">&lt;/<span class="name">App</span>&gt;</span></span>) <span class="comment">// 渲染组件到页面</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="select-单选"><a href="#select-单选" class="headerlink" title="select 单选"></a>select 单选</h4><ul>
<li>01 与上面的同理 , 将 state 中的变量绑定到下拉框的 value 属性  </li>
<li>02 绑定 onChange 事件,在回调中修改 state 中的数据</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">fruit</span>: <span class="string">&#x27;orange&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleFruitChange</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> options = <span class="title class_">Array</span>.<span class="title function_">from</span>(event.<span class="property">target</span>.<span class="property">selectedOptions</span>)</span><br><span class="line">    <span class="keyword">const</span> values = options.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">value</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">fruit</span>: values &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 额外补充: Array.from(可迭代对象)</span></span><br><span class="line">    <span class="comment">// Array.from(arguments)</span></span><br><span class="line">    <span class="keyword">const</span> values2 = <span class="title class_">Array</span>.<span class="title function_">from</span>(event.<span class="property">target</span>.<span class="property">selectedOptions</span>, <span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">value</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(values2)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; fruit &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/* select */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">&#123;fruit&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleFruitChange(e)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;apple&quot;</span>&gt;</span>苹果<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;orange&quot;</span>&gt;</span>橘子<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;banana&quot;</span>&gt;</span>香蕉<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="select-多选"><a href="#select-多选" class="headerlink" title="select 多选"></a>select 多选</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">fruit</span>: [<span class="string">&#x27;orange&#x27;</span>],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  <span class="title function_">handleFruitChange</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> options = <span class="title class_">Array</span>.<span class="title function_">from</span>(event.<span class="property">target</span>.<span class="property">selectedOptions</span>)</span><br><span class="line">    <span class="keyword">const</span> values = options.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">value</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">fruit</span>: values &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 额外补充: Array.from(可迭代对象)</span></span><br><span class="line">    <span class="comment">// Array.from(arguments)</span></span><br><span class="line">    <span class="keyword">const</span> values2 = <span class="title class_">Array</span>.<span class="title function_">from</span>(event.<span class="property">target</span>.<span class="property">selectedOptions</span>, <span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">value</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(values2)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; fruit &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/* select */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">&#123;fruit&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleFruitChange(e)&#125; multiple&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;apple&quot;</span>&gt;</span>苹果<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;orange&quot;</span>&gt;</span>橘子<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;banana&quot;</span>&gt;</span>香蕉<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="复选框单选"><a href="#复选框单选" class="headerlink" title="复选框单选"></a>复选框单选</h4><ul>
<li>01 与上面的同理 , 将 state 中的变量绑定到复选框的 checked 属性  </li>
<li>02 绑定 onChange 事件,在回调中修改 state 中的数据</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">isAgree</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  <span class="title function_">handleAgreeChange</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">isAgree</span>: event.<span class="property">target</span>.<span class="property">checked</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; isAgree &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/* checkbox单选 */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&quot;agree&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;agree&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&#123;isAgree&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleAgreeChange(e)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            同意协议</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="复选框多选"><a href="#复选框多选" class="headerlink" title="复选框多选"></a>复选框多选</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">hobbies</span>: [</span><br><span class="line">        &#123; <span class="attr">value</span>: <span class="string">&#x27;sing&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;唱&#x27;</span>, <span class="attr">isChecked</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">value</span>: <span class="string">&#x27;dance&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;跳&#x27;</span>, <span class="attr">isChecked</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">value</span>: <span class="string">&#x27;rap&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;rap&#x27;</span>, <span class="attr">isChecked</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// form 表单的提交事件回调</span></span><br><span class="line">  <span class="title function_">handleSubmitClick</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="comment">// 1.阻止默认的行为</span></span><br><span class="line">    event.<span class="title function_">preventDefault</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.获取到所有的表单数据, 对数据进行组件</span></span><br><span class="line">    <span class="keyword">const</span> hobbies = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hobbies</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">isChecked</span>).<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">value</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取爱好: &#x27;</span>, hobbies)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.以网络请求的方式, 将数据传递给服务器(ajax/fetch/axios)</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 事件回调</span></span><br><span class="line">  <span class="title function_">handleHobbiesChange</span>(<span class="params">event, index</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> hobbies = [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hobbies</span>]</span><br><span class="line">    hobbies[index].<span class="property">isChecked</span> = event.<span class="property">target</span>.<span class="property">checked</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; hobbies &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; hobbies &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleSubmitClick(e)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          &#123;/* checkbox多选 */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            您的爱好:</span></span><br><span class="line"><span class="language-xml">            &#123;hobbies.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&#123;item.value&#125;</span> <span class="attr">key</span>=<span class="string">&#123;item.value&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&#123;item.value&#125;</span> <span class="attr">checked</span>=<span class="string">&#123;item.isChecked&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleHobbiesChange(e, index)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;item.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="对多表单回调优化"><a href="#对多表单回调优化" class="headerlink" title="对多表单回调优化"></a>对多表单回调优化</h4><ul>
<li><p>问题：每个表单元素都需要一个单独的事件处理程序，处理太繁琐</p>
</li>
<li><p>优化：使用一个事件处理程序处理多个表单元素</p>
</li>
<li><p>步骤:</p>
<ul>
<li>给表单元素添加 name 属性，名称与 state 属性名相同</li>
<li>根据表单元素类型获取对应的值</li>
<li>在事件处理程序中通过<code>[name]</code>修改对应的 state</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">// 01 导入react和react-dom</span><br><span class="line">import React from &#x27;react&#x27;</span><br><span class="line">import ReactDOM from &#x27;react-dom/client&#x27;</span><br><span class="line"></span><br><span class="line">// 02 创建组件</span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    username: &#x27;&#x27;,</span><br><span class="line">    desc: &#x27;&#x27;,</span><br><span class="line">    city: &#x27;2&#x27;,</span><br><span class="line">    isSingle: true,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 事件回调</span><br><span class="line">  handleChange = (e) =&gt; &#123;</span><br><span class="line">    // 通过 type 属性判断表单的类型</span><br><span class="line">    let &#123; name, type, value, checked &#125; = e.target</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      // 在 ES6 之前,对象的属性名必须指定,属性值可以是任意表达式</span><br><span class="line">      // 在 ES6 之后,对象的属性名和和属性值都可以是任意表达式,但是表达式作为属性使用,必须放在[]中</span><br><span class="line">      [name]: type === &#x27;checkbox&#x27; ? checked : value, // [name] : 动态属性 , 该 name 值来自表单的属性,且与 state 中的变量同名</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        姓名：</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;username&quot; value=&#123;this.state.username&#125; onChange=&#123;this.handleChange&#125; /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        描述：</span><br><span class="line">        &lt;textarea name=&quot;desc&quot; value=&#123;this.state.desc&#125; onChange=&#123;this.handleChange&#125;&gt;&lt;/textarea&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        城市：</span><br><span class="line">        &lt;select name=&quot;city&quot; value=&#123;this.state.city&#125; onChange=&#123;this.handleChange&#125;&gt;</span><br><span class="line">          &lt;option value=&quot;1&quot;&gt;北京&lt;/option&gt;</span><br><span class="line">          &lt;option value=&quot;2&quot;&gt;上海&lt;/option&gt;</span><br><span class="line">          &lt;option value=&quot;3&quot;&gt;广州&lt;/option&gt;</span><br><span class="line">          &lt;option value=&quot;4&quot;&gt;深圳&lt;/option&gt;</span><br><span class="line">        &lt;/select&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        是否单身：</span><br><span class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;isSingle&quot; checked=&#123;this.state.isSingle&#125; onChange=&#123;this.handleChange&#125; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 03 渲染react元素</span><br><span class="line">const root = ReactDOM.createRoot(document.getElementById(&#x27;root&#x27;)) // 指定渲染到那个容器</span><br><span class="line">root.render(&lt;App&gt;&lt;/App&gt;) // 渲染组件到页面</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="非受控组件"><a href="#非受控组件" class="headerlink" title="非受控组件"></a>非受控组件</h3><ul>
<li><p>React 推荐大多数情况下使用受控组件 来处理表单数据：</p>
<ul>
<li>一个受控组件中，表单数据是由 React 组件来管理的；</li>
<li>另一种替代方案是使用非受控组件，这时表单数据将交由 DOM 节点来处理；</li>
</ul>
</li>
<li><p>如果要使用非受控组件中的数据，那么我们需要使用 ref 来从 DOM 节点中获取表单数据。</p>
<ul>
<li>我们来进行一个简单的演练：</li>
<li>使用 ref 来获取 input 元素；</li>
</ul>
</li>
<li><p>在非受控组件中通常使用 defaultValue 来设置默认值；</p>
<ul>
<li>同样，<code>&lt;input type=&quot;checkbox&quot;&gt;</code> 和 <code>&lt;input type=&quot;radio&quot;&gt; </code>支持 defaultChecked，<code>&lt;select&gt; </code>和<code> &lt;textarea&gt;</code> 支持 defaultValue。</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; createRef, <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">intro</span>: <span class="string">&#x27;哈哈哈&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">introRef</span> = <span class="title function_">createRef</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleSubmitClick</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="comment">// 1.阻止默认的行为</span></span><br><span class="line">    event.<span class="title function_">preventDefault</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.获取到所有的表单数据, 对数据进行组件</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取结果:&#x27;</span>, <span class="variable language_">this</span>.<span class="property">introRef</span>.<span class="property">current</span>.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.以网络请求的方式, 将数据传递给服务器(ajax/fetch/axios)</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; intro &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.handleSubmitClick(e)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          &#123;/* 5.非受控组件 */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">defaultValue</span>=<span class="string">&#123;intro&#125;</span> <span class="attr">ref</span>=<span class="string">&#123;this.introRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="高阶组件"><a href="#高阶组件" class="headerlink" title="高阶组件"></a>高阶组件</h3><h4 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h4><ul>
<li>什么是高阶组件呢？<ul>
<li>相信很多同学都知道（听说过？），也用过 高阶函数</li>
<li>它们非常相似，所以我们可以先来回顾一下什么是 高阶函数。</li>
</ul>
</li>
<li>高阶函数的维基百科定义：至少满足以下条件之一：<ul>
<li><strong>接受一个或多个函数作为输入；</strong></li>
<li><strong>输出一个函数；</strong></li>
</ul>
</li>
<li>JavaScript 中比较常见的 filter、map、reduce 都是高阶函数。</li>
<li>那么什么是高阶组件呢？<ul>
<li>高阶组件的英文是 Higher-Order Components，简称为 HOC；</li>
<li>官方的定义：<strong>高阶组件是参数为组件，返回值为新组件的函数</strong>；</li>
</ul>
</li>
<li>我们可以进行如下的解析：<ul>
<li>首先，高阶组件 本身不是一个组件，而是一个函数；</li>
<li>其次，这个函数的参数是一个组件，返回值也是一个组件；</li>
</ul>
</li>
</ul>
<h4 id="高阶组件的定义"><a href="#高阶组件的定义" class="headerlink" title="高阶组件的定义"></a>高阶组件的定义</h4><ul>
<li>高阶组件的编写和调用过程类似于这样：</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个高阶组件</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hoc</span>(<span class="params">Cpn</span>) &#123;</span><br><span class="line">  <span class="comment">// 1.定义类组件</span></span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">NewCpn</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Cpn</span> <span class="attr">name</span>=<span class="string">&quot;why&quot;</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">NewCpn</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 定义函数组件</span></span><br><span class="line">  <span class="comment">// function NewCpn2(props) &#123;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// return NewCpn2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HelloWorld</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HelloWorldHOC</span> = <span class="title function_">hoc</span>(<span class="title class_">HelloWorld</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HelloWorldHOC</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>组件的名称问题：<ul>
<li>在 ES6 中，类表达式中类名是可以省略的；</li>
<li>组件的名称都可以通过 displayName 来修改；</li>
</ul>
</li>
<li>高阶组件并不是 React API 的一部分，它是基于 React 的组合特性而形成的设计模式；</li>
<li>高阶组件在一些 React 第三方库中非常常见：<ul>
<li>比如 redux 中的 connect；（后续会讲到）</li>
<li>比如 react-router 中的 withRouter；（后续会讲到）</li>
</ul>
</li>
</ul>
<h4 id="应用一-props的增强"><a href="#应用一-props的增强" class="headerlink" title="应用一:props的增强"></a>应用一:props的增强</h4><ul>
<li>修改原有代码的情况下，添加新的props</li>
<li>利用高阶组件来共享Context</li>
</ul>
<p><strong>.&#x2F;enhanced_props</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义组件: 给一些需要特殊数据的组件, 注入props</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">enhancedUserInfo</span>(<span class="params">OriginComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">NewComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">      <span class="variable language_">super</span>(props)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">        <span class="attr">userInfo</span>: &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;coderwhy&#x27;</span>,</span><br><span class="line">          <span class="attr">level</span>: <span class="number">99</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">OriginComponent</span> &#123;<span class="attr">...this.props</span>&#125; &#123;<span class="attr">...this.state.userInfo</span>&#125; /&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">NewComponent</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> enhancedUserInfo</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>.&#x2F;About.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> enhancedUserInfo <span class="keyword">from</span> <span class="string">&#x27;../enhanced_props&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">About</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>About: &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">enhancedUserInfo</span>(<span class="title class_">About</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> enhancedUserInfo <span class="keyword">from</span> <span class="string">&#x27;./enhanced_props&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&#x27;./components/About&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">enhancedUserInfo</span>(<span class="keyword">function</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home: &#123;props.name&#125;-&#123;props.level&#125;-&#123;props.banners&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Profile</span> = <span class="title function_">enhancedUserInfo</span>(<span class="keyword">function</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Profile: &#123;props.name&#125;-&#123;props.level&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HelloFriend</span> = <span class="title function_">enhancedUserInfo</span>(<span class="keyword">function</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>HelloFriend: &#123;props.name&#125;-&#123;props.level&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Home</span> <span class="attr">banners</span>=<span class="string">&#123;[</span>&quot;<span class="attr">轮播1</span>&quot;, &quot;<span class="attr">轮播2</span>&quot;]&#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Profile</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HelloFriend</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">About</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="应用二-Context"><a href="#应用二-Context" class="headerlink" title="应用二:Context"></a>应用二:Context</h4><p><strong>.&#x2F;context&#x2F;theme_context.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createContext &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeContext</span> = <span class="title function_">createContext</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ThemeContext</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>..&#x2F;hoc&#x2F;with_theme.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;../context/theme_context&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">withTheme</span>(<span class="params">OriginComponment</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">ThemeContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;(value) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">OriginComponment</span> &#123;<span class="attr">...value</span>&#125; &#123;<span class="attr">...props</span>&#125; /&gt;</span>&#123;/* 3. 给传递进来的子组件注入数据 */&#125;</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ThemeContext.Consumer</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withTheme</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>.&#x2F;components&#x2F;Product.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> withTheme <span class="keyword">from</span> <span class="string">&#x27;../hoc/with_theme&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Product</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; color, size &#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Product: &#123;color&#125;-&#123;size&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withTheme</span>(<span class="title class_">Product</span>) <span class="comment">// 2. 将子组件传递给高阶组件进行处理</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;./context/theme_context&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Product&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 1. 为后代组件提供数据 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> &#x27;<span class="attr">red</span>&#x27;, <span class="attr">size:</span> <span class="attr">30</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="应用三-登录鉴权"><a href="#应用三-登录鉴权" class="headerlink" title="应用三:登录鉴权"></a>应用三:登录鉴权</h4><ul>
<li>在开发中，我们可能遇到这样的场景：<ul>
<li>某些页面是必须用户登录成功才能进行进入；</li>
<li>如果用户没有登录成功，那么直接跳转到登录页面；</li>
</ul>
</li>
<li>这个时候，我们就可以使用高阶组件来完成鉴权操作：</li>
</ul>
<p><strong>..&#x2F;hoc&#x2F;login_auth.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loginAuth</span>(<span class="params">OriginComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;token&#x27;</span>) <span class="comment">// 读取 token</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">OriginComponent</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>请先登录, 再进行跳转到对应的页面中<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> loginAuth</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>.&#x2F;components&#x2F;Cart.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> loginAuth <span class="keyword">from</span> <span class="string">&#x27;../hoc/login_auth&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Cart</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Cart Page<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">loginAuth</span>(<span class="title class_">Cart</span>) <span class="comment">// 将当前组件传入高阶组件进行处理</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Cart</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 按钮点击事件回调</span></span><br><span class="line">  <span class="title function_">loginClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;coderwhy&#x27;</span>) <span class="comment">// 存储 token</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">forceUpdate</span>() <span class="comment">// 强制更新组件</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        App</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.loginClick()&#125;&gt;登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Cart</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="应用四-生命周期劫持"><a href="#应用四-生命周期劫持" class="headerlink" title="应用四:生命周期劫持"></a>应用四:生命周期劫持</h4><ul>
<li>我们也可以利用高阶函数来劫持生命周期，在生命周期中完成自己的逻辑：</li>
</ul>
<p><strong>..&#x2F;hoc&#x2F;log_render_time.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logRenderTime</span>(<span class="params">OriginComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">PureComponent</span> &#123;</span><br><span class="line">    <span class="title function_">UNSAFE_componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">beginTime</span> = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">endTime</span> = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()</span><br><span class="line">      <span class="keyword">const</span> interval = <span class="variable language_">this</span>.<span class="property">endTime</span> - <span class="variable language_">this</span>.<span class="property">beginTime</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`当前<span class="subst">$&#123;OriginComponent.name&#125;</span>页面花费了<span class="subst">$&#123;interval&#125;</span>ms渲染完成!`</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">OriginComponent</span> &#123;<span class="attr">...this.props</span>&#125;/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> logRenderTime</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>.&#x2F;components&#x2F;Detail.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logRenderTime <span class="keyword">from</span> <span class="string">&#x27;../hoc/log_render_time&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Detail</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Detail Page<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表7<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表8<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表9<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>数据列表10<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">logRenderTime</span>(<span class="title class_">Detail</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Detail</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Detail&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Detail</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="高阶组件的意义"><a href="#高阶组件的意义" class="headerlink" title="高阶组件的意义"></a>高阶组件的意义</h4><ul>
<li>我们会发现利用高阶组件可以针对某些 React 代码进行更加优雅的处理。</li>
<li>其实早期的 React 有提供组件之间的一种复用方式是 mixin，目前已经不再建议使用：<ul>
<li>Mixin 可能会相互依赖，相互耦合，不利于代码维护；</li>
<li>不同的 Mixin 中的方法可能会相互冲突；</li>
<li>Mixin 非常多时，组件处理起来会比较麻烦，甚至还要为其做相关处理，这样会给代码造成滚雪球式的复杂性；</li>
</ul>
</li>
<li>当然，HOC 也有自己的一些缺陷：<ul>
<li>HOC 需要在原组件上进行包裹或者嵌套，如果大量使用 HOC，将会产生非常多的嵌套，这让调试变得非常困难；</li>
<li>HOC 可以劫持 props，在不遵守约定的情况下也可能造成冲突；</li>
</ul>
</li>
<li>Hooks 的出现，是开创性的，它解决了很多 React 之前的存在的问题<ul>
<li>比如 this 指向问题、比如 hoc 的嵌套复杂度问题等等；</li>
</ul>
</li>
<li>后续我们还会专门来学习 hooks 相关的知识，敬请期待；</li>
</ul>
<h3 id="ref的转发"><a href="#ref的转发" class="headerlink" title="ref的转发"></a>ref的转发</h3><ul>
<li>在前面我们学习 ref 时讲过，ref 不能应用于函数式组件：<ul>
<li>因为函数式组件没有实例，所以不能获取到对应的组件对象</li>
</ul>
</li>
<li>但是，在开发中我们可能想要获取函数式组件中某个元素的 DOM，这个时候我们应该如何操作呢？<ul>
<li>方式一：直接传入 ref 属性（错误的做法）</li>
<li>方式二：通过 forwardRef 高阶函数；</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/c9c3bada48904758adfcfb9438cc71af" alt="1671527308472"></p>
<h3 id="Portals"><a href="#Portals" class="headerlink" title="Portals"></a>Portals</h3><h4 id="Portals的使用"><a href="#Portals的使用" class="headerlink" title="Portals的使用"></a>Portals的使用</h4><ul>
<li>某些情况下，我们希望渲染的内容独立于父组件，甚至是独立于当前挂载到的DOM元素中（默认都是挂载到id为root的DOM元素上的）。</li>
<li>Portal 提供了一种将子节点渲染到存在于父组件以外的 DOM 节点的优秀的方案：<ul>
<li>第一个参数（child）是任何可渲染的 React 子元素，例如一个元素，字符串或 fragment；</li>
<li>第二个参数（container）是一个 DOM 元素；</li>
</ul>
</li>
</ul>
<p><strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPortal &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;app&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>App H1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          createPortal(<span class="tag">&lt;<span class="name">h2</span>&gt;</span>App H2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>, document.querySelector(&quot;#why&quot;)) &#123;/* h2 结构会被挂载到另一个容器 #why 下面 */&#125;</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>通常来讲，当你从组件的 render 方法返回一个元素时，该元素将被挂载到 DOM 节点中离其最近的父节点：</li>
<li>然而，有时候将子元素插入到 DOM 节点中的不同位置也是有好处的：</li>
</ul>
<h4 id="Modal组件案例"><a href="#Modal组件案例" class="headerlink" title="Modal组件案例"></a>Modal组件案例</h4><ul>
<li>比如说，我们准备开发一个 Modal 组件，它可以将它的子组件渲染到屏幕的中间位置：</li>
<li>步骤一：修改 index.html , 添加新的容器节点 <code>div#modal</code></li>
<li>步骤二：编写这个节点的样式</li>
<li>步骤三：编写组件代码</li>
</ul>
<p><strong>.&#x2F;Modal.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPortal &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Modal</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createPortal</span>(<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span>, <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#modal&quot;</span>)) <span class="comment">// 给该组件传入的结构将会挂载到容器 div#modal 下面</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Modal</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>App.jsx</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Modal</span> <span class="keyword">from</span> <span class="string">&#x27;./Modal&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;app&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>App H1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        </span></span><br><span class="line"><span class="language-xml">        &#123;/* 2.Modal组件 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Modal</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h2</span>&gt;</span>我是标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是内容, 哈哈哈<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Modal</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="fragment"><a href="#fragment" class="headerlink" title="fragment"></a>fragment</h3><ul>
<li>在之前的开发中，我们总是在一个组件中返回内容时包裹一个 div 元素：</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://s1.vika.cn/space/2023/03/12/66fcd15e5b5e4db6b407326995e3e00a" alt="1666592279401"></p>
<ul>
<li>我们又希望可以不渲染这样一个 div 应该如何操作呢？<ul>
<li>使用 Fragment</li>
<li>Fragment 允许你将子列表分组，而无需向 DOM 添加额外节点；</li>
</ul>
</li>
<li>React 还提供了 Fragment 的短语法：<ul>
<li>它看起来像空标签<code> &lt;&gt; &lt;/&gt;</code>；</li>
<li>但是，<strong>如果我们需要在 Fragment 中添加 key，那么就不能使用短语法</strong></li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span>, <span class="title class_">Fragment</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">sections</span>: [</span><br><span class="line">        &#123; <span class="attr">title</span>: <span class="string">&quot;哈哈哈&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;我是内容, 哈哈哈&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">title</span>: <span class="string">&quot;呵呵呵&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;我是内容, 呵呵呵&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">title</span>: <span class="string">&quot;嘿嘿嘿&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;我是内容, 嘿嘿嘿&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">title</span>: <span class="string">&quot;嘻嘻嘻&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;我是内容, 嘻嘻嘻&quot;</span> &#125;,</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; sections &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>我是App的标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是App的内容, 哈哈哈哈<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          sections.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Fragment</span> <span class="attr">key</span>=<span class="string">&#123;item.title&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;item.content&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">Fragment</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            )</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h3><ul>
<li><p>StrictMode 是一个用来突出显示应用程序中潜在问题的工具：</p>
<ul>
<li>与 Fragment 一样，StrictMode 不会渲染任何可见的 UI；</li>
<li>它为其后代元素触发额外的检查和警告；</li>
<li>严格模式检查仅在开发模式下运行；它们不会影响生产构建；</li>
</ul>
</li>
<li><p>可以为应用程序的任何部分启用严格模式：</p>
<ul>
<li>用 <code>&lt;StrictMode&gt;&lt;/StrictMode&gt;</code>组件将, 需要开启严格模式的组件进行包裹,即可运行严格模式对指定组件进行检查；</li>
<li>对 app 根组件开启严格模式:  <code>&lt;StrictMode&gt; &lt;App /&gt; &lt;/StrictMode&gt;</code></li>
</ul>
</li>
<li><p>但是检测，到底检测什么呢？</p>
<ul>
<li><strong>识别不安全的生命周期</strong></li>
<li><strong>使用过时的 ref API</strong></li>
<li><strong>检查意外的副作用</strong><ul>
<li>这个组件的 constructor 会被调用两次；</li>
<li>这是严格模式下故意进行的操作，让你来查看在这里写的一些逻辑代码被调用多次时，是否会产生一些副作用；</li>
<li>在生产环境中，是不会被调用两次的；</li>
</ul>
</li>
<li><strong>使用废弃的 findDOMNode 方法</strong><ul>
<li>在之前的 React API 中，可以通过 findDOMNode 来获取 DOM，不过已经不推荐使用了，严格模式下已废弃 , 可以自行学习演练一下</li>
</ul>
</li>
<li><strong>检测过时的 context API</strong><ul>
<li>早期的 Context 是通过 static 属性声明 Context 对象属性，通过 getChildContext 返回 Context 对象等方式来使用 Context 的；</li>
<li>目前这种方式已经不推荐使用，大家可以自行学习了解一下它的用法；</li>
</ul>
</li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author_group"><a class="post-copyright__author_img" href="/about/"><img class="post-copyright__author_img_front" src= "/img/loading.gif" data-lazy-src="https://bu.dusays.com/2023/11/08/654af68b25bb8.jpg"></a><div class="post-copyright__author_name">蜗牛浪迹天涯</div><div class="post-copyright__author_desc">宁静致远，热爱生活。</div></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div id="quit-box" onclick="RemoveRewardMask()"></div><div class="post-reward" onclick="AddRewardMask()"><div class="reward-button" title="赞赏作者"><i class="scoicon sco-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><ul class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a target="_blank" rel="noopener" href="https://bu.dusays.com/2023/11/07/6549e79364fa3.png"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://bu.dusays.com/2023/11/07/6549e79364fa3.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://bu.dusays.com/2023/11/07/6549e79d02bd6.png" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://bu.dusays.com/2023/11/07/6549e79d02bd6.png" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></ul></div></div><script>function RemoveRewardMask() {
    let rewardMainElements = document.querySelectorAll(".reward-main");
    let quitBoxElement = document.querySelector("#quit-box");

    console.log("RemoveRewardMask")

    rewardMainElements.forEach(element => {
        element.style.display = "none";
    });

    if (quitBoxElement) {
        quitBoxElement.style.display = "none";
    }
}

function AddRewardMask() {
    let rewardMainElements = document.querySelectorAll(".reward-main");
    let quitBoxElement = document.querySelector("#quit-box");

    console.log("AddRewardMask")

    rewardMainElements.forEach(element => {
        element.style.display = "flex";
    });

    if (quitBoxElement) {
        quitBoxElement.style.display = "flex";
    }
}</script></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本文是原创文章，采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>协议，完整转载请注明来自<a href="/">蜗牛浪迹天涯</a></span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__tag-list"></div></div></div><nav class="needEndHide pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/23/Web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/303_React/30302_React_%E8%BF%87%E6%B8%A1%E5%8A%A8%E7%94%BB%E4%B8%8ECSS%E6%A0%B7%E5%BC%8F/"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">React过渡动画与CSS</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/23/Web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/302_Vue3/30207_Vue3_Vue3%E5%8E%9F%E7%90%86/"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Vue3_Vue3原理</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><div class="author-info__top-group"><div class="author-info__sayhi" id="author-info__sayhi" onclick="sco.changeSayHelloText()">一日之计在于晨</div></div></div><div class="avatar-img-group"><img class="avatar-img" alt="头像" src= "/img/loading.gif" data-lazy-src="https://bu.dusays.com/2023/11/08/654af68b25bb8.jpg"><div class="avatar-sticker"><img class="avatar-sticker-img" src= "/img/loading.gif" data-lazy-src="https://bu.dusays.com/2023/12/30/659011053e246.png" alt="心情贴纸"></div></div><div class="author-info__description_group"><div class="author-info__description">分享自己对编程的<b>热爱</b>，对美好生活的<b>向往</b>，对知识海洋<b>探索历程</b>。</div><div class="author-info__description2">相信你可以在这里找到对你有用的知识和教程。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><div class="author-info__name">snail289</div><div class="author-info__desc">宁静致远，热爱生活。</div></a><div class="card-info-social-icons is-center"><a class="social-icon" target="_blank" rel="noopener" href="https://github.com/DuoSco/Hexo-Theme-slitude" title="Github"><i class="scoicon sco-github-line"></i></a><a class="social-icon" target="_blank" rel="noopener" href="https://space.bilibili.com/1329819902" title="Bilibili"><i class="scoicon sco-bilibili-line"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="scoicon sco-menu-line"></i><span>文章目录</span></div><div class="toc-content" id="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#React-%E7%AE%80%E4%BB%8B"><span class="toc-text">React 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E7%AE%80%E4%BB%8B-1"><span class="toc-text">React 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E5%9C%A8%E5%89%8D%E7%AB%AF%E7%9A%84%E5%9C%B0%E4%BD%8D"><span class="toc-text">React 在前端的地位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E7%9A%84%E6%8A%80%E6%9C%AF%E7%89%B9%E7%82%B9"><span class="toc-text">React 的技术特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vue%E5%92%8CReact%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-text">Vue和React的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E8%AF%BE%E5%A0%82%E4%BD%93%E7%B3%BB"><span class="toc-text">React 课堂体系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%82%82%E9%80%85React%E5%BC%80%E5%8F%91"><span class="toc-text">邂逅React开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-text">React 的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">React 的特点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">声明式编程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91"><span class="toc-text">组件化开发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E5%B9%B3%E5%8F%B0%E9%80%82%E9%85%8D"><span class="toc-text">多平台适配</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E5%BC%80%E5%8F%91%E4%BE%9D%E8%B5%96"><span class="toc-text">React 开发依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#React-%E5%BC%80%E5%8F%91%E4%BE%9D%E8%B5%96-1"><span class="toc-text">React 开发依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Babel%E4%B8%8EReact%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">Babel与React的关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#React-%E7%9A%84%E4%BE%9D%E8%B5%96%E5%BC%95%E5%85%A5"><span class="toc-text">React 的依赖引入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E5%B0%8F%E6%A1%88%E4%BE%8B"><span class="toc-text">React 小案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">案例需求分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hello-World-%E6%A1%88%E4%BE%8B"><span class="toc-text">Hello World 案例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hello-React-%E6%A1%88%E4%BE%8B"><span class="toc-text">Hello React 案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VScode%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5"><span class="toc-text">VScode代码片段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91-1"><span class="toc-text">组件化开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hello-%E6%A1%88%E4%BE%8B%E7%BB%84%E4%BB%B6%E5%8C%96"><span class="toc-text">Hello 案例组件化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BE%9D%E8%B5%96"><span class="toc-text">数据依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84-this-%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98"><span class="toc-text">方法的 this 指向问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91%E6%A1%88%E4%BE%8B"><span class="toc-text">组件化开发案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E5%BD%B1%E5%88%97%E8%A1%A8%E5%B1%95%E7%A4%BA"><span class="toc-text">电影列表展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E6%95%B0%E5%99%A8%E6%A1%88%E4%BE%8B"><span class="toc-text">计数器案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React-JSX%E8%AF%AD%E6%B3%95"><span class="toc-text">React JSX语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86-JSX"><span class="toc-text">认识 JSX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9-JSX"><span class="toc-text">为什么选择 JSX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSX-%E7%9A%84%E4%B9%A6%E5%86%99%E8%A7%84%E8%8C%83"><span class="toc-text">JSX 的书写规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSX%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">JSX的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JSX-%E4%B8%AD%E7%9A%84%E6%B3%A8%E9%87%8A"><span class="toc-text">JSX 中的注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSX-%E5%B5%8C%E5%85%A5%E5%8F%98%E9%87%8F"><span class="toc-text">JSX 嵌入变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSX-%E5%B5%8C%E5%85%A5%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">JSX 嵌入表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSX-%E7%BB%91%E5%AE%9A%E5%B1%9E%E6%80%A7"><span class="toc-text">JSX 绑定属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React-%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-text">React 事件绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A-1"><span class="toc-text">React 事件绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#this-%E7%BB%91%E5%AE%9A"><span class="toc-text">this 绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3-this-%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98"><span class="toc-text">解决 this 指向问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-text">方法二</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89"><span class="toc-text">方法三</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%9B%9B"><span class="toc-text">方法四</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="toc-text">事件参数传递</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E6%A1%88%E4%BE%8B"><span class="toc-text">事件绑定案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React-%E6%B8%B2%E6%9F%93"><span class="toc-text">React 渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-text">React 条件渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if-%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-text">if 条件渲染</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">三元运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">逻辑运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93%E6%A1%88%E4%BE%8B"><span class="toc-text">条件渲染案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-text">React 列表渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#React-%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93-1"><span class="toc-text">React 列表渲染</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93%E6%A1%88%E4%BE%8B"><span class="toc-text">列表渲染案例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E4%B8%AD%E7%9A%84-key"><span class="toc-text">列表中的 key</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSX-%E5%8E%9F%E7%90%86"><span class="toc-text">JSX 原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JSX%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="toc-text">JSX的本质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E7%BC%96%E5%86%99-JSX"><span class="toc-text">直接编写 JSX</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9FDOM%E7%9A%84%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="toc-text">虚拟DOM的创建过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E7%BC%96%E7%A8%8B-1"><span class="toc-text">声明式编程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%A1%88%E4%BE%8B%E7%BB%83%E4%B9%A0"><span class="toc-text">购物车案例练习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React-%E8%84%9A%E6%89%8B%E6%9E%B6"><span class="toc-text">React 脚手架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E7%9A%84%E5%A4%8D%E6%9D%82%E5%8C%96"><span class="toc-text">前端工程的复杂化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%84%9A%E6%89%8B%E6%9E%B6"><span class="toc-text">什么是脚手架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E8%84%9A%E6%89%8B%E6%9E%B6"><span class="toc-text">前端脚手架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-node"><span class="toc-text">安装 node</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-React-%E9%A1%B9%E7%9B%AE"><span class="toc-text">创建 React 项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90"><span class="toc-text">目录结构分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3-PWA"><span class="toc-text">了解 PWA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%89%8B%E6%9E%B6%E4%B8%AD%E7%9A%84-Webpack"><span class="toc-text">脚手架中的 Webpack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%88%A0%E9%99%A4"><span class="toc-text">文件结构删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E4%B9%A6%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-text">开始书写代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91-2"><span class="toc-text">组件化开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91"><span class="toc-text">什么是组件化开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React%E7%9A%84%E7%BB%84%E4%BB%B6%E5%8C%96"><span class="toc-text">React的组件化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React%E7%BB%84%E4%BB%B6%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">React组件的分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6"><span class="toc-text">类组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6-1"><span class="toc-text">类组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#render%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">render函数的返回值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6"><span class="toc-text">函数组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">组件生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">认识生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%A7%A3%E6%9E%90"><span class="toc-text">生命周期解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text">生命周期函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-text">构造器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#render"><span class="toc-text">render</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%8C%82%E8%BD%BD"><span class="toc-text">组件挂载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%9B%B4%E6%96%B0"><span class="toc-text">组件更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%8D%B8%E8%BD%BD"><span class="toc-text">组件卸载</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">不常用的生命周期</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-text">组件间通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E5%B5%8C%E5%A5%97"><span class="toc-text">组件的嵌套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-text">认识组件间通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA"><span class="toc-text">服务器动态数据展示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C%E4%B8%8E%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-text">参数校验与默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E7%88%B6%E7%BB%84%E4%BB%B6"><span class="toc-text">子组件传递父组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1%E6%A1%88%E4%BE%8B"><span class="toc-text">组件间通信案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E6%A7%BD%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">插槽的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E6%A7%BD%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">插槽的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#children%E5%AE%9E%E7%8E%B0%E6%8F%92%E6%A7%BD"><span class="toc-text">children实现插槽</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#props%E5%AE%9E%E7%8E%B0%E6%8F%92%E6%A7%BD"><span class="toc-text">props实现插槽</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">作用域插槽的实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context"><span class="toc-text">Context</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Context-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">Context 基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Context%E7%9B%B8%E5%85%B3API"><span class="toc-text">Context相关API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Context%E7%9A%84%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-text">Context的默认值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF"><span class="toc-text">全局事件总线</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setState-%E9%9A%BE%E7%82%B9"><span class="toc-text">setState(难点)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8setState"><span class="toc-text">为什么使用setState</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setState%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0"><span class="toc-text">setState异步更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BC%82%E6%AD%A5%E7%9A%84%E7%BB%93%E6%9E%9C"><span class="toc-text">获取异步的结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setState%E7%9A%84%E5%BC%82%E6%AD%A5"><span class="toc-text">setState的异步</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React%E7%9A%84%E6%9B%B4%E6%96%B0%E6%9C%BA%E5%88%B6-%E9%9A%BE%E7%82%B9"><span class="toc-text">React的更新机制(难点)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#React%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B"><span class="toc-text">React更新流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#keys%E7%9A%84%E4%BC%98%E5%8C%96"><span class="toc-text">keys的优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#render%E5%87%BD%E6%95%B0%E7%9A%84%E4%BC%98%E5%8C%96"><span class="toc-text">render函数的优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SCU%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95"><span class="toc-text">SCU生命周期方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PureComponent"><span class="toc-text">PureComponent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowEqual%E6%96%B9%E6%B3%95"><span class="toc-text">shallowEqual方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6memo"><span class="toc-text">高阶组件memo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%8D%E5%8F%AF%E5%8F%98"><span class="toc-text">数据的不可变</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E9%AB%98%E7%BA%A7%E5%86%85%E5%AE%B9"><span class="toc-text">其他高级内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8ref"><span class="toc-text">如何使用ref</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ref%E8%8E%B7%E5%8F%96%E7%B1%BB%E7%BB%84%E4%BB%B6%E5%AE%9E%E4%BE%8B"><span class="toc-text">ref获取类组件实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ref%E8%8E%B7%E5%8F%96%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%E7%9A%84DOM"><span class="toc-text">ref获取函数组件的DOM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ref%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">ref的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="toc-text">受控组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="toc-text">常见的受控组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E6%A1%86"><span class="toc-text">文本框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E5%9F%9F"><span class="toc-text">文本域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#select-%E5%8D%95%E9%80%89"><span class="toc-text">select 单选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#select-%E5%A4%9A%E9%80%89"><span class="toc-text">select 多选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E9%80%89%E6%A1%86%E5%8D%95%E9%80%89"><span class="toc-text">复选框单选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E9%80%89%E6%A1%86%E5%A4%9A%E9%80%89"><span class="toc-text">复选框多选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E5%A4%9A%E8%A1%A8%E5%8D%95%E5%9B%9E%E8%B0%83%E4%BC%98%E5%8C%96"><span class="toc-text">对多表单回调优化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="toc-text">非受控组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6"><span class="toc-text">高阶组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0"><span class="toc-text">高阶函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">高阶组件的定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E4%B8%80-props%E7%9A%84%E5%A2%9E%E5%BC%BA"><span class="toc-text">应用一:props的增强</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E4%BA%8C-Context"><span class="toc-text">应用二:Context</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E4%B8%89-%E7%99%BB%E5%BD%95%E9%89%B4%E6%9D%83"><span class="toc-text">应用三:登录鉴权</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9B%9B-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%8A%AB%E6%8C%81"><span class="toc-text">应用四:生命周期劫持</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-text">高阶组件的意义</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ref%E7%9A%84%E8%BD%AC%E5%8F%91"><span class="toc-text">ref的转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Portals"><span class="toc-text">Portals</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Portals%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">Portals的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Modal%E7%BB%84%E4%BB%B6%E6%A1%88%E4%BE%8B"><span class="toc-text">Modal组件案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fragment"><span class="toc-text">fragment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F"><span class="toc-text">严格模式</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="scoicon sco-map-line"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_01/" title="Python基础-01"><img alt="Python基础-01" src= "/img/loading.gif" data-lazy-src="https://tse2-mm.cn.bing.net/th/id/OIP-C.fs21LLVsDhIQJeG3UilvswHaEK?w=306&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;pid=1.7"></a><div class="content"><a class="title" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_01/" title="Python基础-01">Python基础-01</a><a class="article-recent_post_categories" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_01/">Python</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_02/" title="Python基础-02"><img alt="Python基础-02" src= "/img/loading.gif" data-lazy-src="https://tse2-mm.cn.bing.net/th/id/OIP-C.fs21LLVsDhIQJeG3UilvswHaEK?w=306&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;pid=1.7"></a><div class="content"><a class="title" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_02/" title="Python基础-02">Python基础-02</a><a class="article-recent_post_categories" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_02/">Python</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_03/" title="Python基础-03"><img alt="Python基础-03" src= "/img/loading.gif" data-lazy-src="https://tse2-mm.cn.bing.net/th/id/OIP-C.fs21LLVsDhIQJeG3UilvswHaEK?w=306&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;pid=1.7"></a><div class="content"><a class="title" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_03/" title="Python基础-03">Python基础-03</a><a class="article-recent_post_categories" href="/2024/02/15/Python/%E9%BB%91%E9%A9%ACPython_03/">Python</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/26/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/007_UI%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/001_UI%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="UI自动化测试"><img alt="UI自动化测试" src= "/img/loading.gif" data-lazy-src="https://tse3-mm.cn.bing.net/th/id/OIP-C.FjupsUlF0U4eTb-7NSK7VQHaEK?w=324&amp;h=182&amp;c=7&amp;r=0&amp;o=5&amp;pid=1.7"></a><div class="content"><a class="title" href="/2024/01/26/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/007_UI%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/001_UI%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="UI自动化测试">UI自动化测试</a><a class="article-recent_post_categories" href="/2024/01/26/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/007_UI%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/001_UI%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">软件测试</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/26/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/006_%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/11_%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-02/" title="性能测试基础02"><img alt="性能测试基础02" src= "/img/loading.gif" data-lazy-src="https://tse1-mm.cn.bing.net/th/id/OIP-C.n0oCh3l8SwuNaJd7YTGnbAHaEo?w=254&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;pid=1.7"></a><div class="content"><a class="title" href="/2024/01/26/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/006_%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/11_%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-02/" title="性能测试基础02">性能测试基础02</a><a class="article-recent_post_categories" href="/2024/01/26/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/006_%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/11_%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-02/">软件测试</a></div></div></div></div></div></div></main><footer id="footer"><div id="sco-footer-bar"><div class="footer-logo"><span class="scoicon">首页</span></div><div class="footer-bar-description">来自蜗牛浪迹天涯 - 宁静致远，热爱生活。的文章</div><a class="footer-bar-link" href="/">了解更多</a></div><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com" title="Github"><i class="scoicon sco-bilibili-line"></i></a><a class="deal_link" href="mailto:1448623289@qq.com" title="Mail"><i class="scoicon sco-mail-line"></i></a><div class="footer_mini_logo" id="footer_mini_logo" title="返回顶部" onclick="sco.toTop()"><img src= "/img/loading.gif" data-lazy-src="https://bu.dusays.com/2023/11/08/654af68b25bb8.jpg" alt="返回顶部"></div><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com" title="Bilibili"><i class="scoicon sco-bilibili-line"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com" title="抖音"><i class="scoicon sco-douyin-fill"></i></a></div><div id="sco-footer"><div class="footer-group"><h3 class="footer-title">导航</h3><div class="footer-links"><a class="footer-item" href="/archives/" title="归档">归档</a><a class="footer-item" href="/categories/" title="分类">分类</a><a class="footer-item" href="/tags/" title="标签">标签</a></div></div><div class="footer-group"><h3 class="footer-title">服务</h3><div class="footer-links"><a class="footer-item" target="_blank" rel="noopener" href="https://aliyun.com/" title="阿里云">阿里云</a><a class="footer-item" target="_blank" rel="noopener" href="https://v6.51.la/" title="51la统计">51la统计</a><a class="footer-item" target="_blank" rel="noopener" href="https://tongji.baidu.com/" title="百度统计">百度统计</a></div></div><div class="footer-group"><h3 class="footer-title">支持</h3><div class="footer-links"><a class="footer-item" href="/about/" title="打赏记录">打赏记录</a><a class="footer-item" target="_blank" rel="noopener" href="https://docs.wzsco.top/" title="文档">文档</a><a class="footer-item" target="_blank" rel="noopener" href="https://blog.wzsco.top/" title="案例">案例</a></div></div><div class="footer-group"><h3 class="footer-title">协议</h3><div class="footer-links"><a class="footer-item" href="/cookies/" title="Cookies">Cookies</a><a class="footer-item" href="/privacy/" title="用户协议">用户协议</a><a class="footer-item" href="/copyright/" title="版权协议">版权协议</a></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div class="copyright">© 2024 By&nbsp;<a class="footer-bar-link" href="/">snail289</a></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/DuoSco/hexo-theme-solitude">主题</a><a class="footer-bar-link cc" href="/copyright/"><i class="scoicon sco-copyright-line"></i><i class="scoicon sco-creative-commons-by-line"></i><i class="scoicon sco-creative-commons-nc-line"></i><i class="scoicon sco-creative-commons-nd-line"></i></a></div></div></div><div class="needEndHide" id="cookies-window"><div class="cookies-window-title">协议提醒助手</div><div class="cookies-window-content"><span class="cookies-tip">查看本站为你的个人隐私做出的努力</span><a class="cookies-link" href="/privacy/" title="本站如何保护你的隐私"><i class="scoicon sco-right-btn-fill"></i></a></div></div></footer></div><!-- inject body--><script src="https://cdn.bootcdn.net/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/lib/lazyload.min.js"></script><script src="/lib/snackbar.min.js"></script><script src="/lib/view-image.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/Swiper/9.2.4/swiper-bundle.min.js"></script><div id="js-pjax"><script id="config-diff">var PAGE_CONFIG = {
    is_post: true,
    is_page: false,
    is_home: false,
    page: 'post',
    toc: true,
    comment: false,
}
</script></div><!-- post-ai)--><script src="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/meting/2.0.1/Meting.min.js"></script><script>const meting_api = 'https://api.injahow.cn/meting/?server=:server&type=:type&id=:id&auth=:auth&r=:r';
</script><script>const coverColorConfig = {
    mode: 'local',
    api: 'https://img2color.meuicat.com/api?img=',
    time: 43200000,
}</script><script src="/lib/cover-color.min.js"></script><!-- waterfall--><script src="/lib/waterfall.min.js"></script><!-- pjax--><script>let pjaxSelectors = [
    'title',
    '#body-wrap',
    '#site-config',
    'meta[name="description"]',
    '#js-pjax',
    'meta[property^="og:"]',
]

const pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
})

document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
})

document.addEventListener('pjax:complete', () => {
    window.refreshFn()
})

document.addEventListener('pjax:error', (e) => {
    if (e.request.status === 404) {
        pjax.loadUrl('/404.html')
    }
})</script><!-- music--><script src="/js/music.js"></script><!-- inject custom body--><script>console.log("body")</script><!-- search--><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="scoicon sco-close-fill"></i></button></nav><div class="search-wrap"><div class="search-box"><input class="search-box-input" id="search-input" type="text" autocomplete="off" spellcheck="false" autocorrect="off" autocapitalize="off" placeholder="输入关键词快速查找"></div><div id="search-results"></div><div id="search-pagination"></div><div id="search-tips"></div></div></div><div id="search-mask"></div></div><script src="/js/extend/search/local-search.js"></script><!-- music--><div class="needEndHide" id="nav-music" onclick="sco.musicToggle()"><div id="nav-music-hoverTips">音乐已暂停</div><meting-js id="8927329843" server="netease" type="playlist" mutex="true" preload="none" data-lrctype="0" order="random" theme="var(--sco-main)"></meting-js></div></body></html><script>const posts=["2024/02/15/Python/黑马Python_01/","2024/02/15/Python/黑马Python_02/","2024/02/15/Python/黑马Python_03/","2024/01/26/软件测试/007_UI自动化测试/001_UI自动化测试/","2024/01/26/软件测试/006_性能测试/11_性能测试-02/","2024/01/26/软件测试/006_性能测试/11_性能测试-01/","2024/01/26/软件测试/005_接口测试/10_接口测试_接口对象封装_接口自动化测试框架_全量字段校验_持续集成/","2024/01/26/软件测试/005_接口测试/09_接口测试_Requests库_UnitTest框架_数据库操作_日志收集/","2024/01/26/软件测试/005_接口测试/08_接口测试_Postman的使用/","2024/01/26/软件测试/005_接口测试/接口测试_慕课网/","2024/01/26/软件测试/005_接口测试/接口自动化测试_慕课网/","2024/01/26/软件测试/005_接口测试/07_接口测试_接口测试基础/","2024/01/25/软件测试/003_MySQL/004_MySQL_运维篇/","2024/01/25/软件测试/003_MySQL/003_MySQL_进阶篇-02/","2024/01/25/软件测试/003_MySQL/002_MySQL_进阶篇-01/","2024/01/25/软件测试/003_MySQL/001_MySQL_基础篇/","2024/01/25/软件测试/002_Linux/001_Linux/","2024/01/25/软件测试/001_软件测试基础/功能测试项目实战_慕课网/","2024/01/25/软件测试/001_软件测试基础/01_软件测试基础_分类_模型_流程_用例_bug管理/","2024/01/24/Web前端开发/402_Webpack/40201_Webpack/","2024/01/24/Web前端开发/401_TypeScript/40101_TypeScript/","2024/01/23/Web前端开发/303_React/30305_React_Hooks解析/","2024/01/23/Web前端开发/303_React/30304_React_Router/","2024/01/23/Web前端开发/303_React/30303_Redux/","2024/01/23/Web前端开发/303_React/30302_React_过渡动画与CSS样式/","2024/01/23/Web前端开发/303_React/30301_React核心基础/","2024/01/23/Web前端开发/302_Vue3/30207_Vue3_Vue3原理/","2024/01/23/Web前端开发/302_Vue3/30206_Vue3_过渡与动画/","2024/01/23/Web前端开发/302_Vue3/30205_Vue3_自定义指令与插件/","2024/01/23/Web前端开发/302_Vue3/30204_Vue3_Pinia/","2024/01/23/Web前端开发/302_Vue3/30203_Vue3_VueX/","2024/01/23/Web前端开发/302_Vue3/30202_Vue3_Router/","2024/01/23/Web前端开发/302_Vue3/30201_Vue3_基础核心/","2024/01/23/Web前端开发/301_Vue2/30103_Vue2_VueX/","2024/01/23/Web前端开发/301_Vue2/30102_Vue2_VueRouter/","2024/01/23/Web前端开发/301_Vue2/30101_Vue2_Vue2Base/","2024/01/23/Web前端开发/206_模块化/20601_ModuleJS/","2024/01/22/Web前端开发/205_Git/20501_Git/","2024/01/21/Web前端开发/204_Fetch/20401_Fetch/","2024/01/20/Web前端开发/203_Axios/20301_Axios/","2024/01/19/Web前端开发/106_JavaScript高级/10509_JS代码的执行原理/","2024/01/19/Web前端开发/202_Promise/20201_Promise/","2024/01/18/Web前端开发/201_Ajax/20101_Ajax/","2024/01/18/Web前端开发/106_JavaScript高级/10508_浏览器执行过程原理/","2024/01/17/Web前端开发/106_JavaScript高级/10507_JS_ES6-ES13/","2024/01/16/Web前端开发/105_JavaScript/10506_JS_BOM/","2024/01/15/Web前端开发/105_JavaScript/10505_JS_DOM/","2024/01/14/Web前端开发/105_JavaScript/10504_JS_Function/","2024/01/13/Web前端开发/105_JavaScript/10503_JS_Object/","2024/01/12/Web前端开发/105_JavaScript/10502_JS_Array/","2024/01/11/Web前端开发/105_JavaScript/10501_JavaScript_Base/","2024/01/10/Web前端开发/104_Less/10401_Less/","2024/01/09/Web前端开发/103_移动端开发/10304_Flex/","2024/01/08/Web前端开发/103_移动端开发/10303_Rem/","2024/01/07/Web前端开发/103_移动端开发/10302_Percent/","2024/01/06/Web前端开发/103_移动端开发/10301_WebMobileBase/","2024/01/05/Web前端开发/102_HTML5_CSS3/10202_CSS3/","2024/01/04/Web前端开发/102_HTML5_CSS3/10201_HTML5/","2024/01/03/Web前端开发/101_HTML_CSS/10103_CSS/","2024/01/02/Web前端开发/101_HTML_CSS/10102_HTML/","2024/01/01/Web前端开发/101_HTML_CSS/10101_WebBase/"];function toRandomPost(){ pjax.loadUrl('/'+posts[Math.floor(Math.random()*posts.length)]); };</script>